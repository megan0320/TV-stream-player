<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Cipl Simple API: CiplMgrHelper.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Cidana_Final_ViewVC.PNG"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Cipl Simple API&#160;<span id="projectnumber">2.0</span></div>
   <div id="projectbrief">Cidana Player Simple API Document (Confidential)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">CiplMgrHelper.h</div>  </div>
</div>
<div class="contents">
<a href="_cipl_mgr_helper_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//=============================================================================</span>
<a name="l00002"></a>00002 <span class="comment">//  CIDANA CONFIDENTIAL INFORMATION</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//      THIS SOURCE CODE IS PROPRIETARY INFORMATION BELONGING TO CIDANA, INC.</span>
<a name="l00005"></a>00005 <span class="comment">//      ANY USE INCLUDING BUT NOT LIMITED TO COPYING OF CODE, CONCEPTS, AND/OR</span>
<a name="l00006"></a>00006 <span class="comment">//      ALGORITHMS IS PROHIBITED EXCEPT WITH EXPRESS WRITTEN PERMISSION BY THE </span>
<a name="l00007"></a>00007 <span class="comment">//      COMPANY.</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">//      THIS CODE AND INFORMATION IS PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY</span>
<a name="l00010"></a>00010 <span class="comment">//      KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE</span>
<a name="l00011"></a>00011 <span class="comment">//      IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR</span>
<a name="l00012"></a>00012 <span class="comment">//      PURPOSE.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">//      Copyright (c) 2011 Cidana, Inc.  All Rights Reserved.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">// This file is furnished as part of the Cidana Playback SDK. </span>
<a name="l00019"></a>00019 <span class="comment">// Usage of this file, code, concepts, and/or algorithms is prohibited</span>
<a name="l00020"></a>00020 <span class="comment">// except under the terms of the Software Licensing Agreement with Cidana.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00030"></a>00030 <span class="preprocessor">#ifndef _CIPLMGRHELPER_H_</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define _CIPLMGRHELPER_H_</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#ifndef _ci_snprintf</span>
<a name="l00034"></a><a class="code" href="_cipl_mgr_helper_8h.html#a5f2ffabce5f79beb90609b5b76d02f1b">00034</a> <span class="preprocessor"></span><span class="preprocessor">#define _ci_snprintf ci_snprintf</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="_base_mgr_8cpp.html#aa0969dcb87d75481725f0a6b3cb31b91">ci_snprintf</a>(TCHAR *buf, <span class="keywordtype">int</span> size, LPCTSTR szFormat, ...);
<a name="l00036"></a>00036 <span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="preprocessor">#ifndef __TS</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">        #if defined(UNICODE)</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span><span class="preprocessor">        #define __TS L&quot;%ls&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span><span class="preprocessor">        #define __TC L&quot;%lc&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">        #define __TA L&quot;%hs&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span><span class="preprocessor">        #define __ATS &quot;%ls&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span><span class="preprocessor">        #define __WTS L&quot;%ls&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span><span class="preprocessor">        #else</span>
<a name="l00046"></a><a class="code" href="_cipl_mgr_helper_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">00046</a> <span class="preprocessor"></span><span class="preprocessor">        #define __TS &quot;%s&quot;</span>
<a name="l00047"></a><a class="code" href="_cipl_mgr_helper_8h.html#a1c6244302e2f4d773ef2188792dd848b">00047</a> <span class="preprocessor"></span><span class="preprocessor">        #define __TC &quot;%c&quot;</span>
<a name="l00048"></a><a class="code" href="_cipl_mgr_helper_8h.html#a02b32e148705d81a39cd71b86fac2d9a">00048</a> <span class="preprocessor"></span><span class="preprocessor">        #define __TA &quot;%s&quot;</span>
<a name="l00049"></a><a class="code" href="_cipl_mgr_helper_8h.html#a0b4cc38289b236d97718dc072193e8f1">00049</a> <span class="preprocessor"></span><span class="preprocessor">        #define __ATS &quot;%s&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">        #ifdef  __GNUC__ </span>
<a name="l00051"></a>00051 <span class="preprocessor"></span><span class="preprocessor">                #define __WTS L&quot;%s&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">        #else</span>
<a name="l00053"></a><a class="code" href="_cipl_mgr_helper_8h.html#a0d183458093e9f5ad85cee7d97d2e6ca">00053</a> <span class="preprocessor"></span><span class="preprocessor">                #define __WTS L&quot;%hs&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">        #endif</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">        #endif</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00065"></a><a class="code" href="class_c_escape_string.html">00065</a> <span class="keyword">class </span><a class="code" href="class_c_escape_string.html">CEscapeString</a>
<a name="l00066"></a>00066 {
<a name="l00067"></a>00067 <span class="keyword">public</span>:
<a name="l00074"></a><a class="code" href="class_c_escape_string.html#a2ddfe15d7298c1f7523a31fc35790188">00074</a>         <a class="code" href="class_c_escape_string.html#a2ddfe15d7298c1f7523a31fc35790188">CEscapeString</a>(<span class="keyword">const</span> TCHAR *szString, LONG lEscape)
<a name="l00075"></a>00075         {
<a name="l00076"></a>00076                 <a class="code" href="class_c_escape_string.html#a0b21a0f1a1a58e65f4c6c9c2ef9a3ced">Alloc</a>(szString,(TCHAR)lEscape);
<a name="l00077"></a>00077         }
<a name="l00078"></a>00078 
<a name="l00085"></a><a class="code" href="class_c_escape_string.html#ac5e4af43e9000e2ec22bef2a658d1fbc">00085</a>         <a class="code" href="class_c_escape_string.html#a2ddfe15d7298c1f7523a31fc35790188">CEscapeString</a>(<span class="keyword">const</span> TCHAR *szString, TCHAR tcEscape)
<a name="l00086"></a>00086         {
<a name="l00087"></a>00087                 <a class="code" href="class_c_escape_string.html#a0b21a0f1a1a58e65f4c6c9c2ef9a3ced">Alloc</a>(szString,tcEscape);
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089 
<a name="l00093"></a><a class="code" href="class_c_escape_string.html#aab353fadd04886c6b199493e506759f3">00093</a>         <a class="code" href="class_c_escape_string.html#aab353fadd04886c6b199493e506759f3">~CEscapeString</a>()
<a name="l00094"></a>00094         {
<a name="l00095"></a>00095                 <span class="keywordflow">if</span>(<a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">m_bCopied</a>)
<a name="l00096"></a>00096                 {
<a name="l00097"></a>00097                         <span class="keywordflow">if</span>(<a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>!=<a class="code" href="class_c_escape_string.html#ac7ab3387d3e70ee993e2503199b8a757">m_szBuffer</a>)
<a name="l00098"></a>00098                                 <span class="keyword">delete</span>[] <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>;
<a name="l00099"></a>00099                         <a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">m_bCopied</a> = FALSE;
<a name="l00100"></a>00100                 }
<a name="l00101"></a>00101                 <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a> = NULL;
<a name="l00102"></a>00102         }
<a name="l00103"></a>00103 
<a name="l00110"></a><a class="code" href="class_c_escape_string.html#ae1f4d80e77db531273546bb6f9224a8f">00110</a>         <a class="code" href="class_c_escape_string.html#ae1f4d80e77db531273546bb6f9224a8f">operator TCHAR *</a>()<span class="keyword"> const</span>
<a name="l00111"></a>00111 <span class="keyword">        </span>{
<a name="l00112"></a>00112                 <span class="keywordflow">return</span> <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>;
<a name="l00113"></a>00113         }
<a name="l00114"></a>00114 
<a name="l00123"></a><a class="code" href="class_c_escape_string.html#af10d803b4134f695693370e890b23750">00123</a>         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_c_escape_string.html#af10d803b4134f695693370e890b23750">NumberEscapes</a>(<span class="keyword">const</span> TCHAR *s, TCHAR e)
<a name="l00124"></a>00124         {
<a name="l00125"></a>00125                 <span class="keywordtype">int</span> i=0;
<a name="l00126"></a>00126 
<a name="l00127"></a>00127                 <span class="keywordflow">if</span>(s==NULL)
<a name="l00128"></a>00128                         <span class="keywordflow">return</span> 0;
<a name="l00129"></a>00129                 <span class="keywordflow">for</span>(;*s;s++)
<a name="l00130"></a>00130                         i += (<span class="keywordtype">int</span>)(*s==_T(<span class="charliteral">&#39;\t&#39;</span>) || *s==_T(<span class="charliteral">&#39;\n&#39;</span>) || *s==e);
<a name="l00131"></a>00131                 <span class="keywordflow">return</span> i;
<a name="l00132"></a>00132         }
<a name="l00133"></a>00133 
<a name="l00141"></a><a class="code" href="class_c_escape_string.html#abc6cac1ee117780b311d8a343e35450b">00141</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_c_escape_string.html#abc6cac1ee117780b311d8a343e35450b">EscapeString</a>(<span class="keyword">const</span> TCHAR *s, TCHAR *d, TCHAR e)
<a name="l00142"></a>00142         {
<a name="l00143"></a>00143                 <span class="keywordflow">if</span>(s==NULL || d==NULL)
<a name="l00144"></a>00144                         <span class="keywordflow">return</span>;
<a name="l00145"></a>00145                 <span class="keywordflow">for</span>(;*s;s++)
<a name="l00146"></a>00146                 {
<a name="l00147"></a>00147                         <span class="keywordflow">if</span>(*s==_T(<span class="charliteral">&#39;\t&#39;</span>))
<a name="l00148"></a>00148                         {
<a name="l00149"></a>00149                                 *d++ = e;
<a name="l00150"></a>00150                                 *d++ = _T(<span class="charliteral">&#39;t&#39;</span>);
<a name="l00151"></a>00151                         }
<a name="l00152"></a>00152                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*s==_T(<span class="charliteral">&#39;\n&#39;</span>))
<a name="l00153"></a>00153                         {
<a name="l00154"></a>00154                                 *d++ = e;
<a name="l00155"></a>00155                                 *d++ = _T(<span class="charliteral">&#39;n&#39;</span>);
<a name="l00156"></a>00156                         }
<a name="l00157"></a>00157                         <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*s==e)
<a name="l00158"></a>00158                         {
<a name="l00159"></a>00159                                 *d++ = e;
<a name="l00160"></a>00160                                 *d++ = e;
<a name="l00161"></a>00161                         }
<a name="l00162"></a>00162                         <span class="keywordflow">else</span>
<a name="l00163"></a>00163                                 *d++ = *s;
<a name="l00164"></a>00164                 }
<a name="l00165"></a>00165                 *d = 0;
<a name="l00166"></a>00166         }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keyword">protected</span>:
<a name="l00169"></a><a class="code" href="class_c_escape_string.html#a0b21a0f1a1a58e65f4c6c9c2ef9a3ced">00169</a>         <span class="keywordtype">void</span> <a class="code" href="class_c_escape_string.html#a0b21a0f1a1a58e65f4c6c9c2ef9a3ced">Alloc</a>(<span class="keyword">const</span> TCHAR *szString, TCHAR tcEsc)
<a name="l00170"></a>00170         {
<a name="l00171"></a>00171                 <span class="keywordtype">int</span> nesc;
<a name="l00172"></a>00172 
<a name="l00173"></a>00173                 <a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">m_bCopied</a> = FALSE;
<a name="l00174"></a>00174                 <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a> = (TCHAR*)szString;
<a name="l00175"></a>00175                 <span class="keywordflow">if</span>(szString &amp;&amp; tcEsc &amp;&amp; (nesc = <a class="code" href="class_c_escape_string.html#af10d803b4134f695693370e890b23750">NumberEscapes</a>(szString, (TCHAR)tcEsc)))
<a name="l00176"></a>00176                 {
<a name="l00177"></a>00177                         <span class="keywordtype">int</span> len;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179                         len = (int)_tcslen(szString)+1+nesc;
<a name="l00180"></a>00180                         <span class="keywordflow">if</span>(len&lt;=(<span class="keywordtype">signed</span>)<a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(<a class="code" href="class_c_escape_string.html#ac7ab3387d3e70ee993e2503199b8a757">m_szBuffer</a>))
<a name="l00181"></a>00181                                 <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a> = <a class="code" href="class_c_escape_string.html#ac7ab3387d3e70ee993e2503199b8a757">m_szBuffer</a>;
<a name="l00182"></a>00182                         <span class="keywordflow">else</span>
<a name="l00183"></a>00183                                 <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a> = <span class="keyword">new</span> TCHAR[len];
<a name="l00184"></a>00184                         <span class="keywordflow">if</span>(<a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>)
<a name="l00185"></a>00185                         {
<a name="l00186"></a>00186                                 <a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">m_bCopied</a> = TRUE;
<a name="l00187"></a>00187                                 <a class="code" href="class_c_escape_string.html#abc6cac1ee117780b311d8a343e35450b">EscapeString</a>(szString, <a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>, (TCHAR)tcEsc);
<a name="l00188"></a>00188                         }
<a name="l00189"></a>00189                 }
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">00192</a>         BOOL <a class="code" href="class_c_escape_string.html#a584210059c45d68150c8f6b95096b42c">m_bCopied</a>;
<a name="l00193"></a><a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">00193</a>         TCHAR *<a class="code" href="class_c_escape_string.html#a27dc1990b469eeb26a8e859799390503">m_szString</a>;
<a name="l00194"></a><a class="code" href="class_c_escape_string.html#ac7ab3387d3e70ee993e2503199b8a757">00194</a>         TCHAR <a class="code" href="class_c_escape_string.html#ac7ab3387d3e70ee993e2503199b8a757">m_szBuffer</a>[256];
<a name="l00195"></a>00195 };
<a name="l00196"></a>00196 
<a name="l00204"></a><a class="code" href="class_c_unescape_string.html">00204</a> <span class="keyword">class </span><a class="code" href="class_c_unescape_string.html">CUnescapeString</a>
<a name="l00205"></a>00205 {
<a name="l00206"></a>00206 <span class="keyword">public</span>:
<a name="l00216"></a><a class="code" href="class_c_unescape_string.html#abb0ee05189ed71d161a3fdce60cdf423">00216</a>         <a class="code" href="class_c_unescape_string.html#abb0ee05189ed71d161a3fdce60cdf423">CUnescapeString</a>(<span class="keyword">const</span> TCHAR *szString, TCHAR tcEscape)
<a name="l00217"></a>00217         {
<a name="l00218"></a>00218                 <span class="keywordtype">int</span> nesc;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220                 <a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">m_bCopied</a> = FALSE;
<a name="l00221"></a>00221                 <a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a> = (TCHAR *)szString;
<a name="l00222"></a>00222                 <span class="keywordflow">if</span>(szString &amp;&amp; tcEscape &amp;&amp; (nesc = <a class="code" href="class_c_unescape_string.html#ae15154751d983ba7914df3e079ba7fa8">NumberUnescapes</a>(szString, tcEscape)))
<a name="l00223"></a>00223                 {
<a name="l00224"></a>00224                         TCHAR *s;
<a name="l00225"></a>00225 
<a name="l00226"></a>00226                         <span class="keywordflow">if</span>((s = <span class="keyword">new</span> TCHAR[_tcslen(szString)+1-nesc]))
<a name="l00227"></a>00227                         {
<a name="l00228"></a>00228                                 <a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a> = s;
<a name="l00229"></a>00229                                 <a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">m_bCopied</a> = TRUE;
<a name="l00230"></a>00230                                 <a class="code" href="class_c_unescape_string.html#a5c9a8101dd9ad68622e11c069b8310a1">UnescapeString</a>(szString,<a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a>, tcEscape);
<a name="l00231"></a>00231                         }
<a name="l00232"></a>00232                 }
<a name="l00233"></a>00233         }
<a name="l00234"></a>00234         
<a name="l00238"></a><a class="code" href="class_c_unescape_string.html#ab069650eb2ab3eadedbab4c3c203a912">00238</a>         <a class="code" href="class_c_unescape_string.html#ab069650eb2ab3eadedbab4c3c203a912">~CUnescapeString</a>()
<a name="l00239"></a>00239         {
<a name="l00240"></a>00240                 <span class="keywordflow">if</span>(<a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">m_bCopied</a>)
<a name="l00241"></a>00241                 {
<a name="l00242"></a>00242                         <span class="keyword">delete</span>[] <a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a>;
<a name="l00243"></a>00243                         <a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">m_bCopied</a> = FALSE;
<a name="l00244"></a>00244                 }
<a name="l00245"></a>00245                 <a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a> = NULL;
<a name="l00246"></a>00246         }
<a name="l00247"></a>00247 
<a name="l00254"></a><a class="code" href="class_c_unescape_string.html#a3439b384caf04d559c801d0789105f2f">00254</a>         <a class="code" href="class_c_unescape_string.html#a3439b384caf04d559c801d0789105f2f">operator TCHAR *</a>()<span class="keyword"> const</span>
<a name="l00255"></a>00255 <span class="keyword">        </span>{
<a name="l00256"></a>00256                 <span class="keywordflow">return</span> <a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a>;
<a name="l00257"></a>00257         }
<a name="l00258"></a>00258 
<a name="l00267"></a><a class="code" href="class_c_unescape_string.html#ae15154751d983ba7914df3e079ba7fa8">00267</a>         <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_c_unescape_string.html#ae15154751d983ba7914df3e079ba7fa8">NumberUnescapes</a>(<span class="keyword">const</span> TCHAR *s, TCHAR e)
<a name="l00268"></a>00268         {
<a name="l00269"></a>00269                 <span class="keywordtype">int</span> i=0;
<a name="l00270"></a>00270 
<a name="l00271"></a>00271                 <span class="keywordflow">if</span>(s==NULL)
<a name="l00272"></a>00272                         <span class="keywordflow">return</span> 0;
<a name="l00273"></a>00273                 <span class="keywordflow">for</span>(;*s;s++)
<a name="l00274"></a>00274                 {
<a name="l00275"></a>00275                         <span class="keywordflow">if</span>(*s==e)
<a name="l00276"></a>00276                         {
<a name="l00277"></a>00277                                 i++;
<a name="l00278"></a>00278                                 <span class="keywordflow">if</span>(s[1])
<a name="l00279"></a>00279                                         s++;
<a name="l00280"></a>00280                         }
<a name="l00281"></a>00281                 }
<a name="l00282"></a>00282                 <span class="keywordflow">return</span> i;
<a name="l00283"></a>00283         }
<a name="l00284"></a>00284 
<a name="l00292"></a><a class="code" href="class_c_unescape_string.html#a5c9a8101dd9ad68622e11c069b8310a1">00292</a>         <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_c_unescape_string.html#a5c9a8101dd9ad68622e11c069b8310a1">UnescapeString</a>(<span class="keyword">const</span> TCHAR *s, TCHAR *d, TCHAR e)
<a name="l00293"></a>00293         {
<a name="l00294"></a>00294                 <span class="keywordflow">if</span>(s==NULL || d==NULL)
<a name="l00295"></a>00295                         <span class="keywordflow">return</span>;
<a name="l00296"></a>00296                 <span class="keywordflow">for</span>(;*s;s++)
<a name="l00297"></a>00297                 {
<a name="l00298"></a>00298                         <span class="keywordflow">if</span>(*s==e)
<a name="l00299"></a>00299                         {
<a name="l00300"></a>00300                                 s++;
<a name="l00301"></a>00301                                 <span class="keywordflow">if</span>(*s==_T(<span class="charliteral">&#39;t&#39;</span>))
<a name="l00302"></a>00302                                         *d++ = _T(<span class="charliteral">&#39;\t&#39;</span>);
<a name="l00303"></a>00303                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*s==_T(<span class="charliteral">&#39;n&#39;</span>))
<a name="l00304"></a>00304                                         *d++ = _T(<span class="charliteral">&#39;\n&#39;</span>);
<a name="l00305"></a>00305                                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(*s==0)
<a name="l00306"></a>00306                                         <span class="keywordflow">break</span>;  <span class="comment">// technically malformed</span>
<a name="l00307"></a>00307                                 <span class="keywordflow">else</span> 
<a name="l00308"></a>00308                                         *d++ = *s;      <span class="comment">// technically malformed if *s!=e</span>
<a name="l00309"></a>00309                         }
<a name="l00310"></a>00310                         <span class="keywordflow">else</span>
<a name="l00311"></a>00311                                 *d++ = *s;
<a name="l00312"></a>00312                 }
<a name="l00313"></a>00313                 *d = 0;
<a name="l00314"></a>00314         }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 <span class="keyword">protected</span>:
<a name="l00317"></a><a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">00317</a>         BOOL <a class="code" href="class_c_unescape_string.html#a741e62377ec4f3d6dfcf9313b6962a9d">m_bCopied</a>;
<a name="l00318"></a><a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">00318</a>         TCHAR *<a class="code" href="class_c_unescape_string.html#a3842beed6133dc4f08dbbe8b2578b8fd">m_szString</a>;
<a name="l00319"></a>00319 };
<a name="l00320"></a>00320 
<a name="l00328"></a><a class="code" href="class_c_split_string.html">00328</a> <span class="keyword">class </span><a class="code" href="class_c_split_string.html">CSplitString</a>
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330 <span class="keyword">public</span>:
<a name="l00342"></a><a class="code" href="class_c_split_string.html#a228e6929172229b0f3a23a91685fb018">00342</a>         <a class="code" href="class_c_split_string.html#a228e6929172229b0f3a23a91685fb018">CSplitString</a>(<span class="keyword">const</span> TCHAR *szString, TCHAR tcSeparator, TCHAR tcEscape, BOOL bCopy, BOOL bSuppressLast)
<a name="l00343"></a>00343         {       <span class="comment">// const cast is permitted here since we create a copy</span>
<a name="l00344"></a>00344                 <a class="code" href="class_c_split_string.html#a1c5017948bbf056221a33b4954a85020">SplitString</a>(const_cast&lt;TCHAR *&gt;(szString),tcSeparator,tcEscape,TRUE,bSuppressLast);
<a name="l00345"></a>00345         }
<a name="l00346"></a><a class="code" href="class_c_split_string.html#a543098bafa7bfcab0857962326bfd18d">00346</a>         <a class="code" href="class_c_split_string.html#a228e6929172229b0f3a23a91685fb018">CSplitString</a>(TCHAR *szString, TCHAR tcSeparator, TCHAR tcEscape, BOOL bCopy, BOOL bSuppressLast)
<a name="l00347"></a>00347         {
<a name="l00348"></a>00348                 <a class="code" href="class_c_split_string.html#a1c5017948bbf056221a33b4954a85020">SplitString</a>(szString, tcSeparator, tcEscape, bCopy, bSuppressLast);
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350 
<a name="l00354"></a><a class="code" href="class_c_split_string.html#ab82b1de1672976949eeac8d3ffb0ad46">00354</a>         <a class="code" href="class_c_split_string.html#ab82b1de1672976949eeac8d3ffb0ad46">~CSplitString</a>()
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356                 <span class="keywordflow">if</span>(<a class="code" href="class_c_split_string.html#a1295a11a8694bc2a4fc04596d42ff54e">m_bCopy</a>)
<a name="l00357"></a>00357                 {
<a name="l00358"></a>00358                         <span class="keywordflow">if</span>(<a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>)
<a name="l00359"></a>00359                         {
<a name="l00360"></a>00360                                 <span class="keyword">delete</span>[] <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>;
<a name="l00361"></a>00361                                 <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a> = NULL;
<a name="l00362"></a>00362                         }
<a name="l00363"></a>00363                 }
<a name="l00364"></a>00364                 <a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a> = 0;
<a name="l00365"></a>00365                 <span class="keywordflow">if</span>(<a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>)
<a name="l00366"></a>00366                 {
<a name="l00367"></a>00367                         <span class="keyword">delete</span>[] <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>;
<a name="l00368"></a>00368                         <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a> = NULL;
<a name="l00369"></a>00369                 }
<a name="l00370"></a>00370         }
<a name="l00371"></a>00371 
<a name="l00380"></a><a class="code" href="class_c_split_string.html#a4da118833da02cacc016794e0a523c2f">00380</a>         TCHAR *<a class="code" href="class_c_split_string.html#a4da118833da02cacc016794e0a523c2f">GetItem</a>(<span class="keywordtype">int</span> nPos)
<a name="l00381"></a>00381         {
<a name="l00382"></a>00382                 <span class="keywordflow">if</span>(nPos&gt;=(<span class="keywordtype">int</span>)<a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a> || nPos&lt;0 || <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>==NULL)
<a name="l00383"></a>00383                         <span class="keywordflow">return</span> NULL;
<a name="l00384"></a>00384                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>[nPos];
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386 
<a name="l00394"></a><a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">00394</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>()
<a name="l00395"></a>00395         {
<a name="l00396"></a>00396                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>;
<a name="l00397"></a>00397         }
<a name="l00398"></a>00398 
<a name="l00407"></a><a class="code" href="class_c_split_string.html#a80849e22e3c0415386e8cac9bf78e80e">00407</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_split_string.html#a80849e22e3c0415386e8cac9bf78e80e">GetNumberSeparators</a>()
<a name="l00408"></a>00408         {
<a name="l00409"></a>00409                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">m_dwSeparators</a>;
<a name="l00410"></a>00410         }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 <span class="keyword">protected</span>:
<a name="l00413"></a><a class="code" href="class_c_split_string.html#a1c5017948bbf056221a33b4954a85020">00413</a>         <span class="keywordtype">void</span> <a class="code" href="class_c_split_string.html#a1c5017948bbf056221a33b4954a85020">SplitString</a>(TCHAR *szString, TCHAR tcSeparator, TCHAR tcEscape, BOOL bCopy, BOOL bSuppressLast)
<a name="l00414"></a>00414         {
<a name="l00415"></a>00415                 <a class="code" href="class_c_split_string.html#a1295a11a8694bc2a4fc04596d42ff54e">m_bCopy</a> = bCopy;
<a name="l00416"></a>00416                 <span class="keywordflow">if</span>(<a class="code" href="class_c_split_string.html#a1295a11a8694bc2a4fc04596d42ff54e">m_bCopy</a>)
<a name="l00417"></a>00417                 {
<a name="l00418"></a>00418                         <span class="keywordtype">int</span> n;
<a name="l00419"></a>00419 
<a name="l00420"></a>00420                         n = (int)_tcslen(szString)+1;
<a name="l00421"></a>00421                         <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a> = <span class="keyword">new</span> TCHAR[n];
<a name="l00422"></a>00422                         _tcscpy(<a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>,szString);
<a name="l00423"></a>00423                 }
<a name="l00424"></a>00424                 <span class="keywordflow">else</span>
<a name="l00425"></a>00425                         <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a> = szString;
<a name="l00426"></a>00426                 <a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a> = 0;
<a name="l00427"></a>00427                 <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a> = NULL;
<a name="l00428"></a>00428                 <a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">m_dwSeparators</a> = 0;
<a name="l00429"></a>00429                 <a class="code" href="class_c_split_string.html#a707b8be0e5c5aee9c974eb63dffadcdb">Split</a>(tcSeparator,bSuppressLast);
<a name="l00430"></a>00430                 <span class="keywordflow">if</span>(tcEscape)
<a name="l00431"></a>00431                 {
<a name="l00432"></a>00432                         <span class="keywordtype">unsigned</span> i;
<a name="l00433"></a>00433 
<a name="l00434"></a>00434                         <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>;i++)
<a name="l00435"></a>00435                                 <a class="code" href="class_c_unescape_string.html#a5c9a8101dd9ad68622e11c069b8310a1">CUnescapeString::UnescapeString</a>(<a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>[i],<a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>[i],tcEscape);
<a name="l00436"></a>00436                 }
<a name="l00437"></a>00437         }
<a name="l00438"></a><a class="code" href="class_c_split_string.html#a707b8be0e5c5aee9c974eb63dffadcdb">00438</a>         <span class="keywordtype">void</span> <a class="code" href="class_c_split_string.html#a707b8be0e5c5aee9c974eb63dffadcdb">Split</a>(TCHAR tc, BOOL bSuppressLast)
<a name="l00439"></a>00439         {
<a name="l00440"></a>00440                 <span class="keywordtype">int</span> i;
<a name="l00441"></a>00441                 TCHAR *sbase, *snext;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443                 <a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">m_dwSeparators</a> = 0;
<a name="l00444"></a>00444                 <span class="comment">// find number of items</span>
<a name="l00445"></a>00445                 <span class="keywordflow">if</span>((sbase = <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>) &amp;&amp; _tcslen(<a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>) &gt; 0)
<a name="l00446"></a>00446                 {
<a name="l00447"></a>00447                         <span class="keywordflow">for</span>(<a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>=1;;<a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>++)
<a name="l00448"></a>00448                         {
<a name="l00449"></a>00449                                 snext = _tcschr(sbase,tc);
<a name="l00450"></a>00450                                 <span class="keywordflow">if</span>(snext==0)
<a name="l00451"></a>00451                                         <span class="keywordflow">break</span>;
<a name="l00452"></a>00452                                 <a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">m_dwSeparators</a>++;
<a name="l00453"></a>00453                                 sbase = snext+1;
<a name="l00454"></a>00454                                 <span class="keywordflow">if</span>(*sbase==0)
<a name="l00455"></a>00455                                 {
<a name="l00456"></a>00456                                         <a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a> += (DWORD)!bSuppressLast;
<a name="l00457"></a>00457                                         <span class="keywordflow">break</span>;
<a name="l00458"></a>00458                                 }
<a name="l00459"></a>00459                         }
<a name="l00460"></a>00460                         sbase = <a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>;
<a name="l00461"></a>00461                         <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a> = <span class="keyword">new</span> TCHAR *[<a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>];
<a name="l00462"></a>00462                         <span class="keywordflow">for</span>(i=0;;i++)
<a name="l00463"></a>00463                         {
<a name="l00464"></a>00464                                 <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>[i] = sbase;
<a name="l00465"></a>00465                                 snext = _tcschr(sbase,tc);
<a name="l00466"></a>00466                                 <span class="keywordflow">if</span>(snext==0)
<a name="l00467"></a>00467                                         <span class="keywordflow">break</span>;
<a name="l00468"></a>00468                                 *snext = 0;
<a name="l00469"></a>00469                                 sbase = snext+1;
<a name="l00470"></a>00470                                 <span class="keywordflow">if</span>(*sbase==0)
<a name="l00471"></a>00471                                 {
<a name="l00472"></a>00472                                         <span class="keywordflow">if</span>(!bSuppressLast)
<a name="l00473"></a>00473                                                 <a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>[++i] = sbase;
<a name="l00474"></a>00474                                         <span class="keywordflow">break</span>;
<a name="l00475"></a>00475                                 }
<a name="l00476"></a>00476                         }                       
<a name="l00477"></a>00477                 }
<a name="l00478"></a>00478         }
<a name="l00479"></a>00479 
<a name="l00480"></a><a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">00480</a>         TCHAR *<a class="code" href="class_c_split_string.html#adfe6dbcf23c4adfd43db6ebfd92a8624">m_szString</a>;
<a name="l00481"></a><a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">00481</a>         TCHAR **<a class="code" href="class_c_split_string.html#a62ecf12fdec9c3d3dece8af3678485d1">m_szArray</a>;
<a name="l00482"></a><a class="code" href="class_c_split_string.html#a1295a11a8694bc2a4fc04596d42ff54e">00482</a>         BOOL <a class="code" href="class_c_split_string.html#a1295a11a8694bc2a4fc04596d42ff54e">m_bCopy</a>;
<a name="l00483"></a><a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">00483</a>         DWORD <a class="code" href="class_c_split_string.html#af4cca6bf793feee994b1f90af078d38f">m_dwSeparators</a>;
<a name="l00484"></a><a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">00484</a>         DWORD <a class="code" href="class_c_split_string.html#ad8a68c06e9f0fe4a136a4dbc753441df">m_dwItems</a>;
<a name="l00485"></a>00485 };
<a name="l00486"></a>00486 
<a name="l00492"></a><a class="code" href="class_c_split_blob.html">00492</a> <span class="keyword">class </span><a class="code" href="class_c_split_blob.html">CSplitBlob</a>
<a name="l00493"></a>00493 {
<a name="l00494"></a>00494 <span class="keyword">public</span>:
<a name="l00504"></a><a class="code" href="class_c_split_blob.html#ae0768ebfa022aa986784b889c2787cc7">00504</a>         <a class="code" href="class_c_split_blob.html#ae0768ebfa022aa986784b889c2787cc7">CSplitBlob</a>(<span class="keyword">const</span> TCHAR *szBlob, TCHAR tcEscape = 0) :
<a name="l00505"></a>00505           <a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>(szBlob,_T(<span class="stringliteral">&#39;\n&#39;</span>),0,TRUE,TRUE)
<a name="l00506"></a>00506         {
<a name="l00507"></a>00507                 <span class="keywordtype">int</span> i;
<a name="l00508"></a>00508 
<a name="l00509"></a>00509                 <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a> = <span class="keyword">new</span> <a class="code" href="class_c_split_string.html">CSplitString</a> *[<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>()];
<a name="l00510"></a>00510                 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>();i++)
<a name="l00511"></a>00511                         <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[i] = <span class="keyword">new</span> <a class="code" href="class_c_split_string.html">CSplitString</a>(<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#a4da118833da02cacc016794e0a523c2f">GetItem</a>(i),_T(<span class="charliteral">&#39;\t&#39;</span>),tcEscape,TRUE,FALSE);       <span class="comment">// this could be false to save space</span>
<a name="l00512"></a>00512         }
<a name="l00516"></a><a class="code" href="class_c_split_blob.html#acb4a6018bfed6371f5eb163524615a14">00516</a>         <a class="code" href="class_c_split_blob.html#acb4a6018bfed6371f5eb163524615a14">~CSplitBlob</a>()
<a name="l00517"></a>00517         {
<a name="l00518"></a>00518                 <span class="keywordtype">int</span> i;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520                 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>();i++)
<a name="l00521"></a>00521                 {
<a name="l00522"></a>00522                         <span class="keyword">delete</span> <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[i];
<a name="l00523"></a>00523                         <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[i] = NULL;
<a name="l00524"></a>00524                 }
<a name="l00525"></a>00525                 <span class="keyword">delete</span>[] <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>;
<a name="l00526"></a>00526         }
<a name="l00537"></a><a class="code" href="class_c_split_blob.html#a8179b7be3fce122a750aa92e5125d883">00537</a>         TCHAR *<a class="code" href="class_c_split_blob.html#a8179b7be3fce122a750aa92e5125d883">GetRow</a>(<span class="keywordtype">int</span> nRow)
<a name="l00538"></a>00538         {
<a name="l00539"></a>00539                 <span class="keywordflow">if</span>(nRow&lt;0 || nRow &gt;<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>())
<a name="l00540"></a>00540                         <span class="keywordflow">return</span> NULL;
<a name="l00541"></a>00541                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#a4da118833da02cacc016794e0a523c2f">GetItem</a>(nRow);
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543 
<a name="l00553"></a><a class="code" href="class_c_split_blob.html#a5322da6c9cbc70263923f558e3447ce7">00553</a>         TCHAR *<a class="code" href="class_c_split_blob.html#a5322da6c9cbc70263923f558e3447ce7">GetItem</a>(<span class="keywordtype">int</span> nRow, <span class="keywordtype">int</span> nCol)
<a name="l00554"></a>00554         {
<a name="l00555"></a>00555                 <span class="keywordflow">if</span>(nRow&lt;0 || nRow &gt;<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>())
<a name="l00556"></a>00556                         <span class="keywordflow">return</span> NULL;
<a name="l00557"></a>00557                 <span class="keywordflow">if</span>(nCol&lt;0 || nCol&gt; <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[nRow]-&gt;GetNumberItems())
<a name="l00558"></a>00558                         <span class="keywordflow">return</span> NULL;
<a name="l00559"></a>00559                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[nRow]-&gt;<a class="code" href="class_c_split_string.html#a4da118833da02cacc016794e0a523c2f">GetItem</a>(nCol);
<a name="l00560"></a>00560         }
<a name="l00561"></a>00561 
<a name="l00568"></a><a class="code" href="class_c_split_blob.html#a7f3089826e0f9e247d82c754175f088d">00568</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_split_blob.html#a7f3089826e0f9e247d82c754175f088d">GetNumberRows</a>()
<a name="l00569"></a>00569         {
<a name="l00570"></a>00570                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>();
<a name="l00571"></a>00571         }
<a name="l00572"></a>00572 
<a name="l00580"></a><a class="code" href="class_c_split_blob.html#a13d9d9a457d120e4e610e229eb6ee237">00580</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_split_blob.html#a13d9d9a457d120e4e610e229eb6ee237">GetNumberCols</a>(<span class="keywordtype">int</span> nRow)
<a name="l00581"></a>00581         {
<a name="l00582"></a>00582                 <span class="keywordflow">if</span>(nRow&lt;0 || nRow &gt;<a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>())
<a name="l00583"></a>00583                         <span class="keywordflow">return</span> 0;
<a name="l00584"></a>00584                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>[nRow]-&gt;<a class="code" href="class_c_split_string.html#af6e2bd97eb3231af054b468e32ee4369">GetNumberItems</a>();
<a name="l00585"></a>00585         }
<a name="l00586"></a>00586 
<a name="l00596"></a><a class="code" href="class_c_split_blob.html#a05402bb41f74732958b7a6ddc21f769c">00596</a>         <span class="keywordtype">bool</span> <a class="code" href="class_c_split_blob.html#a05402bb41f74732958b7a6ddc21f769c">IsArray</a>()
<a name="l00597"></a>00597         {
<a name="l00598"></a>00598                 <span class="keywordflow">return</span> <a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>.<a class="code" href="class_c_split_string.html#a80849e22e3c0415386e8cac9bf78e80e">GetNumberSeparators</a>()!=0;
<a name="l00599"></a>00599         }
<a name="l00600"></a>00600 
<a name="l00605"></a><a class="code" href="class_c_split_blob.html#ade58548074512817ea03df04ff1975dc">00605</a>         <span class="keywordtype">void</span> <a class="code" href="class_c_split_blob.html#ade58548074512817ea03df04ff1975dc">Print</a>()
<a name="l00606"></a>00606         {
<a name="l00607"></a>00607                 <span class="keywordtype">int</span> i,j;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609                 <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="class_c_split_blob.html#a7f3089826e0f9e247d82c754175f088d">GetNumberRows</a>();i++)
<a name="l00610"></a>00610                 {
<a name="l00611"></a>00611                         <span class="keywordflow">if</span>(<a class="code" href="class_c_split_blob.html#a05402bb41f74732958b7a6ddc21f769c">IsArray</a>())
<a name="l00612"></a>00612                                 _tprintf(_T(<span class="stringliteral">&quot;[%d] &quot;</span>),i);        <span class="comment">// arrays have a newline in it</span>
<a name="l00613"></a>00613                         <span class="keywordflow">for</span>(j=0;j&lt;<a class="code" href="class_c_split_blob.html#a13d9d9a457d120e4e610e229eb6ee237">GetNumberCols</a>(i);j++)
<a name="l00614"></a>00614                         {
<a name="l00615"></a>00615                                 _tprintf(_T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="_cipl_mgr_helper_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="_cipl_mgr_helper_8h.html#a1c6244302e2f4d773ef2188792dd848b">__TC</a>,
<a name="l00616"></a>00616                                         <a class="code" href="class_c_split_blob.html#a5322da6c9cbc70263923f558e3447ce7">GetItem</a>(i,j),
<a name="l00617"></a>00617                                         j==<a class="code" href="class_c_split_blob.html#a13d9d9a457d120e4e610e229eb6ee237">GetNumberCols</a>(i)-1 ? _T(<span class="charliteral">&#39;\n&#39;</span>) : _T(<span class="charliteral">&#39; &#39;</span>));
<a name="l00618"></a>00618                         }
<a name="l00619"></a>00619                 }
<a name="l00620"></a>00620         }
<a name="l00621"></a>00621 
<a name="l00622"></a>00622 <span class="keyword">protected</span>:
<a name="l00623"></a><a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">00623</a>         <a class="code" href="class_c_split_string.html">CSplitString</a> <a class="code" href="class_c_split_blob.html#a21d920459413fec23061e48f3e66cef2">m_Row</a>;
<a name="l00624"></a><a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">00624</a>         <a class="code" href="class_c_split_string.html">CSplitString</a> **<a class="code" href="class_c_split_blob.html#a583e05d9a9c96b015aea13da4407099e">m_pColArray</a>;
<a name="l00625"></a>00625 };
<a name="l00626"></a>00626 
<a name="l00627"></a><a class="code" href="class_c_base64_func.html">00627</a> <span class="keyword">class </span><a class="code" href="class_c_base64_func.html">CBase64Func</a>
<a name="l00628"></a>00628 {
<a name="l00630"></a>00630 <span class="keyword">protected</span>:
<a name="l00631"></a><a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">00631</a>     <span class="keyword">static</span> <span class="keywordtype">char</span>  <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> n )
<a name="l00632"></a>00632     {
<a name="l00633"></a>00633         n &amp;= 0x3F;
<a name="l00634"></a>00634         <span class="keywordflow">if</span> ( n &lt; 26 )
<a name="l00635"></a>00635             <span class="keywordflow">return</span> ( <span class="keywordtype">char</span> )( n + <span class="charliteral">&#39;A&#39;</span> );
<a name="l00636"></a>00636         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( n &lt; 52 )
<a name="l00637"></a>00637             <span class="keywordflow">return</span> ( <span class="keywordtype">char</span> )( n - 26 + <span class="charliteral">&#39;a&#39;</span> );
<a name="l00638"></a>00638         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( n &lt; 62 )
<a name="l00639"></a>00639             <span class="keywordflow">return</span> ( <span class="keywordtype">char</span> )( n - 52 + <span class="charliteral">&#39;0&#39;</span> );
<a name="l00640"></a>00640         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( n == 62 )
<a name="l00641"></a>00641             <span class="keywordflow">return</span> <span class="charliteral">&#39;+&#39;</span>;
<a name="l00642"></a>00642         <span class="keywordflow">else</span>
<a name="l00643"></a>00643             <span class="keywordflow">return</span> <span class="charliteral">&#39;/&#39;</span>;
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645 
<a name="l00646"></a><a class="code" href="class_c_base64_func.html#ad0530d154a8e20cdb0568ab27b9535bc">00646</a>     <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_c_base64_func.html#ad0530d154a8e20cdb0568ab27b9535bc">char2base</a>( <span class="keywordtype">char</span> c )
<a name="l00647"></a>00647     {
<a name="l00648"></a>00648         <span class="keywordflow">if</span> ( c &gt;= <span class="charliteral">&#39;A&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;Z&#39;</span> )
<a name="l00649"></a>00649             <span class="keywordflow">return</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> )( c - <span class="charliteral">&#39;A&#39;</span> );
<a name="l00650"></a>00650         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;z&#39;</span> )
<a name="l00651"></a>00651             <span class="keywordflow">return</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> )( c - <span class="charliteral">&#39;a&#39;</span> + 26 );
<a name="l00652"></a>00652         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; c &lt;= <span class="charliteral">&#39;9&#39;</span> )
<a name="l00653"></a>00653             <span class="keywordflow">return</span> ( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> )( c - <span class="charliteral">&#39;0&#39;</span> + 52 );
<a name="l00654"></a>00654         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c == <span class="charliteral">&#39;+&#39;</span> )
<a name="l00655"></a>00655             <span class="keywordflow">return</span> 62;
<a name="l00656"></a>00656         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( c == <span class="charliteral">&#39;/&#39;</span> )
<a name="l00657"></a>00657             <span class="keywordflow">return</span> 63;
<a name="l00658"></a>00658         <span class="keywordflow">else</span>
<a name="l00659"></a>00659             <span class="keywordflow">return</span> 64;
<a name="l00660"></a>00660     }
<a name="l00661"></a>00661 
<a name="l00662"></a>00662 <span class="keyword">public</span>:
<a name="l00663"></a>00663     <span class="comment">//aLen is the buffer length of aSrc, and aDest buffer length must be 1.33*aLen at least;</span>
<a name="l00664"></a><a class="code" href="class_c_base64_func.html#a8d1f2301cfd0e69a9ee6632b6c35b273">00664</a>     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_c_base64_func.html#a8d1f2301cfd0e69a9ee6632b6c35b273">base64_encode</a>( <span class="keywordtype">char</span> * <span class="keyword">const</span> aDest, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * aSrc, <span class="keywordtype">int</span> aLen )
<a name="l00665"></a>00665     {
<a name="l00666"></a>00666         <span class="keywordtype">char</span>  * p = aDest;
<a name="l00667"></a>00667         <span class="keywordtype">int</span>   i = 0;
<a name="l00668"></a>00668         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> t = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00669"></a>00669 
<a name="l00670"></a>00670         <span class="keywordflow">for</span> ( i = 0; i &lt; aLen; i++ )
<a name="l00671"></a>00671         {
<a name="l00672"></a>00672             <span class="keywordflow">switch</span> ( i % 3 )
<a name="l00673"></a>00673             {
<a name="l00674"></a>00674             <span class="keywordflow">case</span> 0 :
<a name="l00675"></a>00675                 *p++ = <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( *aSrc &gt;&gt; 2 );
<a name="l00676"></a>00676                 t = ( *aSrc++ &lt;&lt; 4 ) &amp; 0x3F;
<a name="l00677"></a>00677                 <span class="keywordflow">break</span>;
<a name="l00678"></a>00678             <span class="keywordflow">case</span> 1 :
<a name="l00679"></a>00679                 *p++ = <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( t | ( *aSrc &gt;&gt; 4 ) );
<a name="l00680"></a>00680                 t = ( *aSrc++ &lt;&lt; 2 ) &amp; 0x3F;
<a name="l00681"></a>00681                 <span class="keywordflow">break</span>;
<a name="l00682"></a>00682             <span class="keywordflow">case</span> 2 :
<a name="l00683"></a>00683                 *p++ = <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( t | ( *aSrc &gt;&gt; 6 ) );
<a name="l00684"></a>00684                 *p++ = <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( *aSrc++ );
<a name="l00685"></a>00685                 <span class="keywordflow">break</span>;
<a name="l00686"></a>00686             }
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688         <span class="keywordflow">if</span> ( aLen % 3 != 0 )
<a name="l00689"></a>00689         {
<a name="l00690"></a>00690             *p++ = <a class="code" href="class_c_base64_func.html#a0fe91acbb579d4980fe7554fcbcb302f">base2char</a>( t );
<a name="l00691"></a>00691             <span class="keywordflow">if</span> ( aLen % 3 == 1 )
<a name="l00692"></a>00692                 *p++ = <span class="charliteral">&#39;=&#39;</span>;
<a name="l00693"></a>00693             *p++ = <span class="charliteral">&#39;=&#39;</span>;
<a name="l00694"></a>00694         }
<a name="l00695"></a>00695         *p = 0;
<a name="l00696"></a>00696         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)( p - aDest );
<a name="l00697"></a>00697     }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     <span class="comment">//aDest buffer length should be enough than 0.75*aSrc;</span>
<a name="l00700"></a><a class="code" href="class_c_base64_func.html#ab9c193a6e17e7b3afda921c0d92511ff">00700</a>     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_c_base64_func.html#ab9c193a6e17e7b3afda921c0d92511ff">base64_decode</a>( <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> aDest, <span class="keyword">const</span> <span class="keywordtype">char</span> * aSrc )
<a name="l00701"></a>00701     {
<a name="l00702"></a>00702         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> * p = aDest;
<a name="l00703"></a>00703         <span class="keywordtype">int</span>             i = 0, n = (int)strlen( aSrc );
<a name="l00704"></a>00704         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>   c = <span class="charliteral">&#39;\0&#39;</span>, t = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         <span class="keywordflow">for</span> ( i = 0; i &lt; n; i++ )
<a name="l00707"></a>00707         {
<a name="l00708"></a>00708             <span class="keywordflow">if</span> ( *aSrc == <span class="charliteral">&#39;=&#39;</span> )
<a name="l00709"></a>00709                 <span class="keywordflow">break</span>;
<a name="l00710"></a>00710             <span class="keywordflow">do</span> 
<a name="l00711"></a>00711             {
<a name="l00712"></a>00712                 <span class="keywordflow">if</span> ( *aSrc )
<a name="l00713"></a>00713                     c = <a class="code" href="class_c_base64_func.html#ad0530d154a8e20cdb0568ab27b9535bc">char2base</a>( *aSrc++ );
<a name="l00714"></a>00714                 <span class="keywordflow">else</span>
<a name="l00715"></a>00715                     c = 65;
<a name="l00716"></a>00716             } <span class="keywordflow">while</span> ( c == 64 );
<a name="l00717"></a>00717             <span class="keywordflow">if</span> ( c == 65 )
<a name="l00718"></a>00718                 <span class="keywordflow">break</span>;
<a name="l00719"></a>00719             <span class="keywordflow">switch</span> ( i % 4 )
<a name="l00720"></a>00720             {
<a name="l00721"></a>00721             <span class="keywordflow">case</span> 0 :
<a name="l00722"></a>00722                 t = c &lt;&lt; 2;
<a name="l00723"></a>00723                 <span class="keywordflow">break</span>;
<a name="l00724"></a>00724             <span class="keywordflow">case</span> 1 :
<a name="l00725"></a>00725                 *p++ = ( <span class="keywordtype">unsigned</span> char )( t | ( c &gt;&gt; 4 ) );
<a name="l00726"></a>00726                 t = ( <span class="keywordtype">unsigned</span> char )( c &lt;&lt; 4 );
<a name="l00727"></a>00727                 <span class="keywordflow">break</span>;
<a name="l00728"></a>00728             <span class="keywordflow">case</span> 2 :
<a name="l00729"></a>00729                 *p++ = ( <span class="keywordtype">unsigned</span> char )( t | ( c &gt;&gt; 2 ) );
<a name="l00730"></a>00730                 t = ( <span class="keywordtype">unsigned</span> char )( c &lt;&lt; 6 );
<a name="l00731"></a>00731                 <span class="keywordflow">break</span>;
<a name="l00732"></a>00732             <span class="keywordflow">case</span> 3 :
<a name="l00733"></a>00733                 *p++ = ( <span class="keywordtype">unsigned</span> char )( t | c );
<a name="l00734"></a>00734                 <span class="keywordflow">break</span>;
<a name="l00735"></a>00735             }
<a name="l00736"></a>00736         }
<a name="l00737"></a>00737         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)( p - aDest );
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739 };
<a name="l00740"></a>00740 
<a name="l00749"></a><a class="code" href="_cipl_mgr_helper_8h.html#a2f54d0db0d01d83b1fb6e8e89dacabe4">00749</a> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="_cipl_mgr_helper_8h.html#a2f54d0db0d01d83b1fb6e8e89dacabe4">PrintBlob</a>(<span class="keyword">const</span> TCHAR *szReturn, TCHAR tcEscape = 0)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751         <a class="code" href="class_c_split_blob.html">CSplitBlob</a>(szReturn,tcEscape).<a class="code" href="class_c_split_blob.html#ade58548074512817ea03df04ff1975dc">Print</a>();
<a name="l00752"></a>00752 }
<a name="l00753"></a>00753 
<a name="l00754"></a><a class="code" href="_cipl_mgr_helper_8h.html#a6f7f4db9556f85270956bb73dea8ded6">00754</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a6f7f4db9556f85270956bb73dea8ded6">ConvertTimeInfoToString</a>(<span class="keyword">const</span> CIPL_TIME_INFO *pTime, <span class="keywordtype">long</span> lOffset, TCHAR *szString, <span class="keywordtype">int</span> nStrlen)
<a name="l00755"></a>00755 {
<a name="l00756"></a>00756         <span class="keywordflow">if</span>(szString==NULL)
<a name="l00757"></a>00757                 <span class="keywordflow">return</span> 0;
<a name="l00758"></a>00758         <span class="keywordflow">if</span>(pTime==NULL)
<a name="l00759"></a>00759         {
<a name="l00760"></a>00760                 szString = 0;
<a name="l00761"></a>00761                 <span class="keywordflow">return</span> 0;
<a name="l00762"></a>00762         }
<a name="l00763"></a>00763         <span class="keywordtype">long</span> lOffsetABS = lOffset &gt; 0 ? lOffset : 0 - lOffset;
<a name="l00764"></a>00764         <span class="keywordflow">return</span> <a class="code" href="_cipl_mgr_helper_8h.html#a5f2ffabce5f79beb90609b5b76d02f1b">_ci_snprintf</a>(szString, nStrlen,
<a name="l00765"></a>00765                 _T(<span class="stringliteral">&quot;%.4u/%.2u/%.2u %.2u:%.2u:%.2u\t&quot;</span>) <a class="code" href="_cipl_mgr_helper_8h.html#a1c6244302e2f4d773ef2188792dd848b">__TC</a> _T(<span class="stringliteral">&quot;%.2u:%.2u:%.2u&quot;</span>),
<a name="l00766"></a>00766                 pTime-&gt;wYear,
<a name="l00767"></a>00767                 pTime-&gt;wMonth,
<a name="l00768"></a>00768                 pTime-&gt;wDay,
<a name="l00769"></a>00769                 pTime-&gt;wHour,
<a name="l00770"></a>00770                 pTime-&gt;wMinute,
<a name="l00771"></a>00771                 pTime-&gt;wSecond,
<a name="l00772"></a>00772                 lOffset&lt;0 ? _T(<span class="charliteral">&#39;-&#39;</span>) : _T(<span class="charliteral">&#39;+&#39;</span>),
<a name="l00773"></a>00773                 lOffsetABS/3600,
<a name="l00774"></a>00774                 (lOffsetABS%3600)/60,
<a name="l00775"></a>00775                 lOffsetABS%60
<a name="l00776"></a>00776                 );
<a name="l00777"></a>00777 }
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="_cipl_mgr_helper_8h.html#a28d41272e83b99cdfae78e7795ff7aba">00779</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a6f7f4db9556f85270956bb73dea8ded6">ConvertTimeInfoToString</a>(<span class="keyword">const</span> CIPL_TIME_INFO *pTime, TCHAR *szString, <span class="keywordtype">int</span> nStrlen)
<a name="l00780"></a>00780 {
<a name="l00781"></a>00781         <span class="keywordflow">if</span>(szString==NULL)
<a name="l00782"></a>00782                 <span class="keywordflow">return</span> 0;
<a name="l00783"></a>00783         <span class="keywordflow">if</span>(pTime==NULL)
<a name="l00784"></a>00784         {
<a name="l00785"></a>00785                 szString = 0;
<a name="l00786"></a>00786                 <span class="keywordflow">return</span> 0;
<a name="l00787"></a>00787         }
<a name="l00788"></a>00788         <span class="keywordflow">return</span> <a class="code" href="_cipl_mgr_helper_8h.html#a5f2ffabce5f79beb90609b5b76d02f1b">_ci_snprintf</a>(szString, nStrlen,
<a name="l00789"></a>00789                         _T(<span class="stringliteral">&quot;%.4u/%.2u/%.2u %.2u:%.2u:%.2u&quot;</span>),
<a name="l00790"></a>00790                         pTime-&gt;wYear,
<a name="l00791"></a>00791                         pTime-&gt;wMonth,
<a name="l00792"></a>00792                         pTime-&gt;wDay,
<a name="l00793"></a>00793                         pTime-&gt;wHour,
<a name="l00794"></a>00794                         pTime-&gt;wMinute,
<a name="l00795"></a>00795                         pTime-&gt;wSecond
<a name="l00796"></a>00796                         );
<a name="l00797"></a>00797 }
<a name="l00798"></a>00798 
<a name="l00799"></a><a class="code" href="_cipl_mgr_helper_8h.html#afe588916b8066503cd339c6b031f6975">00799</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#afe588916b8066503cd339c6b031f6975">ConvertStringToTimeInfo</a>(<span class="keyword">const</span> TCHAR *szString, CIPL_TIME_INFO *pTime)
<a name="l00800"></a>00800 {
<a name="l00801"></a>00801         <span class="keywordflow">if</span>(pTime==NULL || szString==NULL)
<a name="l00802"></a>00802                 <span class="keywordflow">return</span> 0;
<a name="l00803"></a>00803         <span class="keywordtype">int</span> n,y,m,d,h,mm,s;
<a name="l00804"></a>00804 
<a name="l00805"></a>00805         n =  _stscanf(szString, 
<a name="l00806"></a>00806                 _T(<span class="stringliteral">&quot;%d/%d/%d %d:%d:%d&quot;</span>),
<a name="l00807"></a>00807                 &amp;y,&amp;m,&amp;d,&amp;h,&amp;mm,&amp;s);
<a name="l00808"></a>00808         <span class="keywordflow">if</span>(n!=6)
<a name="l00809"></a>00809         {
<a name="l00810"></a>00810                 ZeroMemory(pTime,<span class="keyword">sizeof</span>(*pTime));
<a name="l00811"></a>00811                 <span class="keywordflow">return</span> 0;
<a name="l00812"></a>00812         }
<a name="l00813"></a>00813         pTime-&gt;wYear = y;
<a name="l00814"></a>00814         pTime-&gt;wMonth = m;
<a name="l00815"></a>00815         pTime-&gt;wDay = d;
<a name="l00816"></a>00816         pTime-&gt;wHour = h;
<a name="l00817"></a>00817         pTime-&gt;wMinute = mm;
<a name="l00818"></a>00818         pTime-&gt;wSecond = s;
<a name="l00819"></a>00819         <span class="keywordflow">return</span> 1;
<a name="l00820"></a>00820 }
<a name="l00821"></a>00821 
<a name="l00822"></a><a class="code" href="_cipl_mgr_helper_8h.html#ae5214bcbf92e109dc53e8f6a109629a2">00822</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#ae5214bcbf92e109dc53e8f6a109629a2">U8ToCode</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *&amp;s)
<a name="l00823"></a>00823 {
<a name="l00824"></a>00824         <span class="keywordtype">unsigned</span> v, v1;
<a name="l00825"></a>00825         
<a name="l00826"></a>00826         v = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)s++;
<a name="l00827"></a>00827         <span class="keywordflow">if</span>(v&lt;0x80)
<a name="l00828"></a>00828                 <span class="keywordflow">return</span> v&amp;0x7f;
<a name="l00829"></a>00829         <span class="keywordflow">if</span>(v&lt;0xc2)       <span class="comment">// 0xc0 are continuation codes,  0xc0 0xc1 invalid 2 byte header.</span>
<a name="l00830"></a>00830                 <span class="keywordflow">return</span> 0;       <span class="comment">// invalid continuation</span>
<a name="l00831"></a>00831         <span class="keywordflow">if</span>(v&lt;0xe0)
<a name="l00832"></a>00832         {
<a name="l00833"></a>00833                 v &amp;= 0x1f;
<a name="l00834"></a>00834                 <span class="keywordflow">goto</span> b3;
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836         <span class="keywordflow">if</span>(v&lt;0xf0)
<a name="l00837"></a>00837         {
<a name="l00838"></a>00838                 v &amp;= 0xf;
<a name="l00839"></a>00839                 <span class="keywordflow">goto</span> b2;
<a name="l00840"></a>00840         }
<a name="l00841"></a>00841         <span class="keywordflow">if</span>(v&lt;0xf5)              <span class="comment">// 0xf8 is true 4 byte limit, but otherwise invalid.</span>
<a name="l00842"></a>00842         {
<a name="l00843"></a>00843                 v &amp;= 0x7;
<a name="l00844"></a>00844                 v1 = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)s++;
<a name="l00845"></a>00845                 <span class="keywordflow">if</span>((v1&amp;0xc0)==0x80)
<a name="l00846"></a>00846                 {
<a name="l00847"></a>00847                         v = v&lt;&lt;6 | v1&amp;0x3f;
<a name="l00848"></a>00848 b2:
<a name="l00849"></a>00849                         v1 = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)s++;
<a name="l00850"></a>00850                         <span class="keywordflow">if</span>((v1&amp;0xc0)==0x80)
<a name="l00851"></a>00851                         {
<a name="l00852"></a>00852                                 v = v&lt;&lt;6 | v1&amp;0x3f;
<a name="l00853"></a>00853 b3:
<a name="l00854"></a>00854                                 v1 = *(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)s++;
<a name="l00855"></a>00855                                 <span class="keywordflow">if</span>((v1&amp;0xc0)==0x80)
<a name="l00856"></a>00856                                         <span class="keywordflow">return</span> v&lt;&lt;6 | v1&amp;0x3f;
<a name="l00857"></a>00857                         }
<a name="l00858"></a>00858                 }
<a name="l00859"></a>00859         }
<a name="l00860"></a>00860         <span class="keywordflow">return</span> 0;
<a name="l00861"></a>00861 }
<a name="l00862"></a>00862         
<a name="l00863"></a><a class="code" href="_cipl_mgr_helper_8h.html#a7ccb6cdb6453d45f297c5449aba5970a">00863</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a7ccb6cdb6453d45f297c5449aba5970a">CodeToU8</a>(<span class="keywordtype">unsigned</span> code, <span class="keywordtype">char</span> *&amp;sptr)
<a name="l00864"></a>00864 {
<a name="l00865"></a>00865         <span class="keywordflow">if</span>(code&lt;0x7f)
<a name="l00866"></a>00866         {
<a name="l00867"></a>00867                 *sptr++ = code;
<a name="l00868"></a>00868                 <span class="keywordflow">return</span> 0;
<a name="l00869"></a>00869         }
<a name="l00870"></a>00870         <span class="keywordflow">if</span>(code&lt;0x7ff)
<a name="l00871"></a>00871         {
<a name="l00872"></a>00872                 *sptr++ = 0xc0 | code&gt;&gt;6 &amp; 0x1f;
<a name="l00873"></a>00873                 *sptr++ = 0x80 | code&amp;0x3f;
<a name="l00874"></a>00874                 <span class="keywordflow">return</span> 0;
<a name="l00875"></a>00875         }
<a name="l00876"></a>00876         <span class="keywordflow">if</span>(code&lt;0xffff)
<a name="l00877"></a>00877         {
<a name="l00878"></a>00878                 *sptr++ = 0xe0 | code&gt;&gt;12 &amp; 0xf;
<a name="l00879"></a>00879                 *sptr++ = 0x80 | code&gt;&gt;6&amp;0x3f;
<a name="l00880"></a>00880                 *sptr++ = 0x80 | code&amp;0x3f;
<a name="l00881"></a>00881                 <span class="keywordflow">return</span> 0;
<a name="l00882"></a>00882         }
<a name="l00883"></a>00883         <span class="keywordflow">if</span>(code&lt;0x1fffff)
<a name="l00884"></a>00884         {
<a name="l00885"></a>00885                 *sptr++ = 0xf0 | code&gt;&gt;18 &amp; 0x7;
<a name="l00886"></a>00886                 *sptr++ = 0x80 | code&gt;&gt;12&amp;0x3f;
<a name="l00887"></a>00887                 *sptr++ = 0x80 | code&gt;&gt;6&amp;0x3f;
<a name="l00888"></a>00888                 *sptr++ = 0x80 | code&amp;0x3f;
<a name="l00889"></a>00889                 <span class="keywordflow">return</span> 0;
<a name="l00890"></a>00890         }
<a name="l00891"></a>00891         <span class="comment">// 5 and 6 byte sequences disallowed.</span>
<a name="l00892"></a>00892         <span class="keywordflow">return</span> -1;
<a name="l00893"></a>00893 }
<a name="l00894"></a>00894 
<a name="l00895"></a><a class="code" href="_cipl_mgr_helper_8h.html#ac8dc9f3aadd43e2ddff59fefb5b3601d">00895</a> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code" href="_cipl_mgr_helper_8h.html#ac8dc9f3aadd43e2ddff59fefb5b3601d">U16ToCode</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *&amp;wptr)
<a name="l00896"></a>00896 {
<a name="l00897"></a>00897         <span class="keywordtype">int</span> code, code2;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899         code = *wptr++;
<a name="l00900"></a>00900         <span class="keywordflow">if</span>(code&lt;=0xd7ff || code&gt;=0xe000)
<a name="l00901"></a>00901                 <span class="keywordflow">return</span> code;
<a name="l00902"></a>00902         <span class="keywordflow">if</span>(code&gt;=0xdc00)
<a name="l00903"></a>00903                 <span class="keywordflow">return</span> 0;       <span class="comment">// error</span>
<a name="l00904"></a>00904         code2 = *wptr++;
<a name="l00905"></a>00905         <span class="keywordflow">if</span>(code2&lt;0xdc00 || code2&gt;=0xe000)
<a name="l00906"></a>00906                 <span class="keywordflow">return</span> 0;
<a name="l00907"></a>00907         <span class="keywordflow">return</span> 0x10000 + ((code&amp;0x3ff)&lt;&lt;10) + (code2 &amp; 0x3ff);
<a name="l00908"></a>00908 }
<a name="l00909"></a>00909 
<a name="l00910"></a><a class="code" href="_cipl_mgr_helper_8h.html#a2baab222831a7fd8d8c289161a7b6e78">00910</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a2baab222831a7fd8d8c289161a7b6e78">CodeToU16</a>(<span class="keywordtype">unsigned</span> code, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *&amp;wptr)
<a name="l00911"></a>00911 {
<a name="l00912"></a>00912         <span class="keywordflow">if</span>(code&lt;=0xd7ff)
<a name="l00913"></a>00913         {
<a name="l00914"></a>00914                 *wptr++ = code;
<a name="l00915"></a>00915                 <span class="keywordflow">return</span> 0;
<a name="l00916"></a>00916         }
<a name="l00917"></a>00917         <span class="keywordflow">if</span>(code&lt;0xe000)
<a name="l00918"></a>00918                 <span class="keywordflow">return</span> -1;
<a name="l00919"></a>00919         <span class="keywordflow">if</span>(code&lt;=0xffff)
<a name="l00920"></a>00920         {
<a name="l00921"></a>00921                 *wptr++ = code;
<a name="l00922"></a>00922                 <span class="keywordflow">return</span> 0;
<a name="l00923"></a>00923         }
<a name="l00924"></a>00924         <span class="keywordflow">if</span>(code&gt;0x10ffff)
<a name="l00925"></a>00925                 <span class="keywordflow">return</span> -1;
<a name="l00926"></a>00926         code -= 0x10000;
<a name="l00927"></a>00927         *wptr++ = 0xd800 | code&gt;&gt;10 &amp; 0x3ff;
<a name="l00928"></a>00928         *wptr++ = 0xdc00 | code &amp; 0x3ff;
<a name="l00929"></a>00929         <span class="keywordflow">return</span> 0;
<a name="l00930"></a>00930 }
<a name="l00931"></a>00931 
<a name="l00932"></a><a class="code" href="_cipl_mgr_helper_8h.html#a0721ea6776eaae22f86bdaf71d40a000">00932</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a0721ea6776eaae22f86bdaf71d40a000">U8ToU16</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *wcstr, <span class="keyword">const</span> <span class="keywordtype">char</span> *mbstr, <span class="keywordtype">size_t</span> count)
<a name="l00933"></a>00933 {
<a name="l00934"></a>00934         <span class="keywordtype">unsigned</span> code;
<a name="l00935"></a>00935         <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *sptr = wcstr;
<a name="l00936"></a>00936 
<a name="l00937"></a>00937         <span class="keywordflow">if</span>(count==0)
<a name="l00938"></a>00938                 <span class="keywordflow">return</span> -1;
<a name="l00939"></a>00939         <span class="keywordflow">while</span>(count&gt;2)
<a name="l00940"></a>00940         {
<a name="l00941"></a>00941                 code = <a class="code" href="_cipl_mgr_helper_8h.html#ae5214bcbf92e109dc53e8f6a109629a2">U8ToCode</a>(mbstr);
<a name="l00942"></a>00942                 <span class="keywordflow">if</span>(code==0)
<a name="l00943"></a>00943                         <span class="keywordflow">break</span>;
<a name="l00944"></a>00944                 <span class="keywordflow">if</span>(<a class="code" href="_cipl_mgr_helper_8h.html#a2baab222831a7fd8d8c289161a7b6e78">CodeToU16</a>(code,sptr)&lt;0)
<a name="l00945"></a>00945                         <span class="keywordflow">break</span>;
<a name="l00946"></a>00946         }
<a name="l00947"></a>00947         *sptr = 0;
<a name="l00948"></a>00948         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(sptr-wcstr);
<a name="l00949"></a>00949 }
<a name="l00950"></a>00950 
<a name="l00951"></a><a class="code" href="_cipl_mgr_helper_8h.html#a4ebc7830f0abc7d96709a26b35e286a9">00951</a> <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="_cipl_mgr_helper_8h.html#a4ebc7830f0abc7d96709a26b35e286a9">U16ToU8</a>(<span class="keywordtype">char</span> *mbstr, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *wcstr, <span class="keywordtype">int</span> count)
<a name="l00952"></a>00952 {
<a name="l00953"></a>00953         <span class="keywordtype">unsigned</span> code;
<a name="l00954"></a>00954         <span class="keywordtype">char</span> *sptr = mbstr;
<a name="l00955"></a>00955 
<a name="l00956"></a>00956         <span class="keywordflow">if</span>(count==0)
<a name="l00957"></a>00957                 <span class="keywordflow">return</span> -1;
<a name="l00958"></a>00958         <span class="keywordflow">while</span>(count&gt;2)
<a name="l00959"></a>00959         {
<a name="l00960"></a>00960                 code = <a class="code" href="_cipl_mgr_helper_8h.html#ac8dc9f3aadd43e2ddff59fefb5b3601d">U16ToCode</a>(wcstr);
<a name="l00961"></a>00961                 <span class="keywordflow">if</span>(code==0)
<a name="l00962"></a>00962                         <span class="keywordflow">break</span>;
<a name="l00963"></a>00963                 <span class="keywordflow">if</span>(<a class="code" href="_cipl_mgr_helper_8h.html#a7ccb6cdb6453d45f297c5449aba5970a">CodeToU8</a>(code,sptr)&lt;0)
<a name="l00964"></a>00964                         <span class="keywordflow">break</span>;
<a name="l00965"></a>00965         }
<a name="l00966"></a>00966         *sptr = 0;
<a name="l00967"></a>00967         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(sptr-mbstr);
<a name="l00968"></a>00968 }
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="class_c_tchar2_char.html">00970</a> <span class="keyword">class </span><a class="code" href="class_c_tchar2_char.html">CTchar2Char</a>
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972 <span class="keyword">public</span>:
<a name="l00982"></a><a class="code" href="class_c_tchar2_char.html#a2d290e5074ab2e76e4c89975ec4f0075">00982</a>         <a class="code" href="class_c_tchar2_char.html#a2d290e5074ab2e76e4c89975ec4f0075">CTchar2Char</a>(<span class="keyword">const</span> TCHAR *szString)
<a name="l00983"></a>00983         {
<a name="l00984"></a>00984                 <a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a> = NULL;
<a name="l00985"></a>00985                 <a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">m_bCopied</a> = FALSE;
<a name="l00986"></a>00986 <span class="preprocessor">#ifndef UNICODE</span>
<a name="l00987"></a>00987 <span class="preprocessor"></span>                <a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a> = (CHAR *)szString;
<a name="l00988"></a>00988 <span class="preprocessor">#else</span>
<a name="l00989"></a>00989 <span class="preprocessor"></span>                <span class="keywordflow">if</span>(<a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a> = <a class="code" href="class_c_tchar2_char.html#a40260955ef05e0aa4ed220175373f94b">NewString</a>(szString))
<a name="l00990"></a>00990                         <a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">m_bCopied</a> = TRUE;
<a name="l00991"></a>00991 <span class="preprocessor">#endif</span>
<a name="l00992"></a>00992 <span class="preprocessor"></span>        }
<a name="l00996"></a><a class="code" href="class_c_tchar2_char.html#ad73a59923445d456e86477e370a35600">00996</a>         <a class="code" href="class_c_tchar2_char.html#ad73a59923445d456e86477e370a35600">~CTchar2Char</a>()
<a name="l00997"></a>00997         {
<a name="l00998"></a>00998                 <span class="keywordflow">if</span>(<a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">m_bCopied</a>)
<a name="l00999"></a>00999                 {
<a name="l01000"></a>01000                         <span class="keyword">delete</span>[] <a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a>;
<a name="l01001"></a>01001                         <a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">m_bCopied</a> = FALSE;
<a name="l01002"></a>01002                 }
<a name="l01003"></a>01003                 <a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a> = NULL;
<a name="l01004"></a>01004         }
<a name="l01005"></a><a class="code" href="class_c_tchar2_char.html#a8c031cfd0c712543615eea14d7d352da">01005</a>         <a class="code" href="class_c_tchar2_char.html#a8c031cfd0c712543615eea14d7d352da">operator CHAR *</a>()<span class="keyword"> const</span>
<a name="l01006"></a>01006 <span class="keyword">        </span>{
<a name="l01007"></a>01007                 <span class="keywordflow">return</span> <a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a>;
<a name="l01008"></a>01008         }
<a name="l01009"></a><a class="code" href="class_c_tchar2_char.html#a40260955ef05e0aa4ed220175373f94b">01009</a>         <span class="keyword">static</span> CHAR *<a class="code" href="class_c_tchar2_char.html#a40260955ef05e0aa4ed220175373f94b">NewString</a>(<span class="keyword">const</span> TCHAR *szString)
<a name="l01010"></a>01010         {
<a name="l01011"></a>01011                 <span class="keywordtype">int</span> len;
<a name="l01012"></a>01012                 CHAR *s;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014                 <span class="keywordflow">if</span>(szString==NULL)
<a name="l01015"></a>01015                         <span class="keywordflow">return</span> NULL;
<a name="l01016"></a>01016 <span class="preprocessor">#ifdef UNICODE</span>
<a name="l01017"></a>01017 <span class="preprocessor"></span>                len = (int)_tcslen(szString)*4 + 1;
<a name="l01018"></a>01018                 s = <span class="keyword">new</span> CHAR[len];
<a name="l01019"></a>01019                 <a class="code" href="_cipl_mgr_helper_8h.html#a4ebc7830f0abc7d96709a26b35e286a9">U16ToU8</a>(s, (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)szString, len);
<a name="l01020"></a>01020                 <span class="comment">//wcstombs(s, szString, len);</span>
<a name="l01021"></a>01021 <span class="preprocessor">#else</span>
<a name="l01022"></a>01022 <span class="preprocessor"></span>                len = _tcslen(szString) + 1;
<a name="l01023"></a>01023                 s = <span class="keyword">new</span> CHAR[len];
<a name="l01024"></a>01024                 _tcscpy(s,szString);
<a name="l01025"></a>01025 <span class="preprocessor">#endif</span>
<a name="l01026"></a>01026 <span class="preprocessor"></span>                <span class="keywordflow">return</span> s;
<a name="l01027"></a>01027         }
<a name="l01028"></a>01028 
<a name="l01029"></a>01029 <span class="keyword">protected</span>:
<a name="l01030"></a><a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">01030</a>         BOOL <a class="code" href="class_c_tchar2_char.html#a2d858f81df347b2cff0ac343af9d853d">m_bCopied</a>;
<a name="l01031"></a><a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">01031</a>         CHAR *<a class="code" href="class_c_tchar2_char.html#ae2d6409d78be92569582ee229c65c7bc">m_szString</a>;
<a name="l01032"></a>01032 };
<a name="l01033"></a>01033 
<a name="l01034"></a><a class="code" href="class_c_char2_tchar.html">01034</a> <span class="keyword">class </span><a class="code" href="class_c_char2_tchar.html">CChar2Tchar</a>
<a name="l01035"></a>01035 {
<a name="l01036"></a>01036 <span class="keyword">public</span>:
<a name="l01046"></a><a class="code" href="class_c_char2_tchar.html#a0360c5efd7ee890b857685ce8f4e4511">01046</a>         <a class="code" href="class_c_char2_tchar.html#a0360c5efd7ee890b857685ce8f4e4511">CChar2Tchar</a>(<span class="keyword">const</span> CHAR *szString)
<a name="l01047"></a>01047         {
<a name="l01048"></a>01048                 <a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a> = NULL;
<a name="l01049"></a>01049                 <a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">m_bCopied</a> = FALSE;
<a name="l01050"></a>01050 <span class="preprocessor">#ifndef UNICODE</span>
<a name="l01051"></a>01051 <span class="preprocessor"></span>                <a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a> = (TCHAR *)szString;
<a name="l01052"></a>01052 <span class="preprocessor">#else</span>
<a name="l01053"></a>01053 <span class="preprocessor"></span>                <span class="keywordflow">if</span>(<a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a> = <a class="code" href="class_c_char2_tchar.html#adb1dcea9adf573ecaff7c7ede383414c">NewString</a>(szString))
<a name="l01054"></a>01054                         <a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">m_bCopied</a> = TRUE;
<a name="l01055"></a>01055 <span class="preprocessor">#endif</span>
<a name="l01056"></a>01056 <span class="preprocessor"></span>        }
<a name="l01057"></a>01057         
<a name="l01061"></a><a class="code" href="class_c_char2_tchar.html#a734b4df086b213ad1cecf573cfad989e">01061</a>         <a class="code" href="class_c_char2_tchar.html#a734b4df086b213ad1cecf573cfad989e">~CChar2Tchar</a>()
<a name="l01062"></a>01062         {
<a name="l01063"></a>01063                 <span class="keywordflow">if</span>(<a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">m_bCopied</a>)
<a name="l01064"></a>01064                 {
<a name="l01065"></a>01065                         <span class="keyword">delete</span>[] <a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a>;
<a name="l01066"></a>01066                         <a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">m_bCopied</a> = FALSE;
<a name="l01067"></a>01067                 }
<a name="l01068"></a>01068                 <a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a> = NULL;
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070 
<a name="l01071"></a><a class="code" href="class_c_char2_tchar.html#a639a44c9556d4aad10474e26185f51fe">01071</a>         <a class="code" href="class_c_char2_tchar.html#a639a44c9556d4aad10474e26185f51fe">operator TCHAR *</a>()<span class="keyword"> const</span>
<a name="l01072"></a>01072 <span class="keyword">        </span>{
<a name="l01073"></a>01073                 <span class="keywordflow">return</span> <a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a>;
<a name="l01074"></a>01074         }
<a name="l01075"></a>01075 
<a name="l01076"></a><a class="code" href="class_c_char2_tchar.html#adb1dcea9adf573ecaff7c7ede383414c">01076</a>         <span class="keyword">static</span> TCHAR *<a class="code" href="class_c_char2_tchar.html#adb1dcea9adf573ecaff7c7ede383414c">NewString</a>(<span class="keyword">const</span> CHAR *szString)
<a name="l01077"></a>01077         {
<a name="l01078"></a>01078                 <span class="keywordtype">int</span> len;
<a name="l01079"></a>01079                 TCHAR *s;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081                 <span class="keywordflow">if</span>(szString==NULL)
<a name="l01082"></a>01082                         <span class="keywordflow">return</span> NULL;
<a name="l01083"></a>01083 <span class="preprocessor">#ifdef UNICODE</span>
<a name="l01084"></a>01084 <span class="preprocessor"></span>                len = (int)strlen(szString)*2+1;
<a name="l01085"></a>01085                 s = <span class="keyword">new</span> TCHAR[len];
<a name="l01086"></a>01086                 <a class="code" href="_cipl_mgr_helper_8h.html#a0721ea6776eaae22f86bdaf71d40a000">U8ToU16</a>((<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *)s,szString,len);
<a name="l01087"></a>01087                 <span class="comment">//mbstowcs(s, szString, len);</span>
<a name="l01088"></a>01088 <span class="preprocessor">#else</span>
<a name="l01089"></a>01089 <span class="preprocessor"></span>                len = _tcslen(szString) + 1;
<a name="l01090"></a>01090                 s = <span class="keyword">new</span> TCHAR[len];
<a name="l01091"></a>01091                 _tcscpy(s,szString);
<a name="l01092"></a>01092 <span class="preprocessor">#endif</span>
<a name="l01093"></a>01093 <span class="preprocessor"></span>                <span class="keywordflow">return</span> s;
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096 <span class="keyword">protected</span>:
<a name="l01097"></a><a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">01097</a>         BOOL <a class="code" href="class_c_char2_tchar.html#a54ffba5180dff309b6f77a372ee5a8fe">m_bCopied</a>;
<a name="l01098"></a><a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">01098</a>         TCHAR *<a class="code" href="class_c_char2_tchar.html#a14c1f15dafc088af1db79080346157b6">m_szString</a>;
<a name="l01099"></a>01099 };
<a name="l01100"></a>01100 
<a name="l01101"></a>01101 <span class="preprocessor">#endif // _CIPLMGRHELPER_H_</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 26 2015 10:59:07 for Cipl Simple API by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
