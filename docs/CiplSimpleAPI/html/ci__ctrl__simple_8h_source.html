<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Cipl Simple API: ci_ctrl_simple.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Cidana_Final_ViewVC.PNG"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Cipl Simple API&#160;<span id="projectnumber">2.0</span></div>
   <div id="projectbrief">Cidana Player Simple API Document (Confidential)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">ci_ctrl_simple.h</div>  </div>
</div>
<div class="contents">
<a href="ci__ctrl__simple_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">//=============================================================================</span>
<a name="l00002"></a>00002 <span class="comment">//  CIDANA CONFIDENTIAL INFORMATION</span>
<a name="l00003"></a>00003 <span class="comment">//</span>
<a name="l00004"></a>00004 <span class="comment">//      THIS SOURCE CODE IS PROPRIETARY INFORMATION BELONGING TO CIDANA, INC.</span>
<a name="l00005"></a>00005 <span class="comment">//      ANY USE INCLUDING BUT NOT LIMITED TO COPYING OF CODE, CONCEPTS, AND/OR</span>
<a name="l00006"></a>00006 <span class="comment">//      ALGORITHMS IS PROHIBITED EXCEPT WITH EXPRESS WRITTEN PERMISSION BY THE </span>
<a name="l00007"></a>00007 <span class="comment">//      COMPANY.</span>
<a name="l00008"></a>00008 <span class="comment">//</span>
<a name="l00009"></a>00009 <span class="comment">//      THIS CODE AND INFORMATION IS PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY</span>
<a name="l00010"></a>00010 <span class="comment">//      KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE</span>
<a name="l00011"></a>00011 <span class="comment">//      IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR</span>
<a name="l00012"></a>00012 <span class="comment">//      PURPOSE.</span>
<a name="l00013"></a>00013 <span class="comment">//</span>
<a name="l00014"></a>00014 <span class="comment">//      Copyright (c) 2011  Cidana, Inc.  All Rights Reserved.</span>
<a name="l00015"></a>00015 <span class="comment">//</span>
<a name="l00016"></a>00016 <span class="comment">//-----------------------------------------------------------------------------</span>
<a name="l00017"></a>00017 <span class="comment">//</span>
<a name="l00018"></a>00018 <span class="comment">// This file is furnished as part of the Cidana Playback SDK. </span>
<a name="l00019"></a>00019 <span class="comment">// Usage of this file, code, concepts, and/or algorithms is prohibited</span>
<a name="l00020"></a>00020 <span class="comment">// except under the terms of the Software Licensing Agreement with Cidana.</span>
<a name="l00021"></a>00021 <span class="comment">//</span>
<a name="l00022"></a>00022 
<a name="l00030"></a>00030 <span class="preprocessor">#ifndef _CI_CTRL_SIMPLE_H_</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#define _CI_CTRL_SIMPLE_H_</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="preprocessor">#ifdef __APPLE__</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span><span class="preprocessor">#define STATIC_LINK_SDK</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a>00037 <span class="preprocessor">#ifdef STATIC_LINK_SDK</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="_cipl_mgr_8h.html">CiplMgr.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#endif</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="preprocessor">#ifndef WINAPI_FAMILY_PARTITION</span>
<a name="l00042"></a><a class="code" href="ci__ctrl__simple_8h.html#ab8d6687fd159c87e84bebac5df86d4b9">00042</a> <span class="preprocessor"></span><span class="preprocessor">#define WINAPI_FAMILY_PARTITION(x) 0</span>
<a name="l00043"></a><a class="code" href="ci__ctrl__simple_8h.html#ac5e9b7a5a9d81eb594fdafae4dbdc591">00043</a> <span class="preprocessor"></span><span class="preprocessor">#define WINAPI_PARTITION_DESKTOP   0</span>
<a name="l00044"></a><a class="code" href="ci__ctrl__simple_8h.html#afb48d1ccff6b11cd213fb93b4af304f3">00044</a> <span class="preprocessor"></span><span class="preprocessor">#define WINAPI_PARTITION_APP       0</span>
<a name="l00045"></a><a class="code" href="ci__ctrl__simple_8h.html#a369327be82fc12f89bcfcd2cc40958d6">00045</a> <span class="preprocessor"></span><span class="preprocessor">#define WINAPI_PARTITION_PC_APP    0</span>
<a name="l00046"></a><a class="code" href="ci__ctrl__simple_8h.html#a221ea17224df30ff13da79825bb3b595">00046</a> <span class="preprocessor"></span><span class="preprocessor">#define WINAPI_PARTITION_PHONE_APP 0</span>
<a name="l00047"></a>00047 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00049"></a>00049 <span class="preprocessor">#ifndef __TS</span>
<a name="l00050"></a>00050 <span class="preprocessor"></span><span class="preprocessor">        #if defined(UNICODE)</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span><span class="preprocessor">        #define __TS L&quot;%ls&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor"></span><span class="preprocessor">        #define __TC L&quot;%lc&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span><span class="preprocessor">        #define __ATS &quot;%ls&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span><span class="preprocessor">        #define __WTS L&quot;%ls&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span><span class="preprocessor">        #else</span>
<a name="l00056"></a><a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">00056</a> <span class="preprocessor"></span><span class="preprocessor">        #define __TS &quot;%s&quot;</span>
<a name="l00057"></a><a class="code" href="ci__ctrl__simple_8h.html#a1c6244302e2f4d773ef2188792dd848b">00057</a> <span class="preprocessor"></span><span class="preprocessor">        #define __TC &quot;%c&quot;</span>
<a name="l00058"></a><a class="code" href="ci__ctrl__simple_8h.html#a0b4cc38289b236d97718dc072193e8f1">00058</a> <span class="preprocessor"></span><span class="preprocessor">        #define __ATS &quot;%s&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span><span class="preprocessor">        #ifdef  __GNUC__ </span>
<a name="l00060"></a>00060 <span class="preprocessor"></span><span class="preprocessor">                #define __WTS L&quot;%s&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span><span class="preprocessor">        #else</span>
<a name="l00062"></a><a class="code" href="ci__ctrl__simple_8h.html#a0d183458093e9f5ad85cee7d97d2e6ca">00062</a> <span class="preprocessor"></span><span class="preprocessor">                #define __WTS L&quot;%hs&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor"></span><span class="preprocessor">        #endif</span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="preprocessor">        #endif</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00066"></a>00066 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="class_c_i___string_alloc.html">00074</a> <span class="keyword">class </span><a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a>
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076 <span class="keyword">public</span>:
<a name="l00087"></a><a class="code" href="class_c_i___string_alloc.html#a5e54128cdba3ae96b50e5fcdeae9b90b">00087</a>         <a class="code" href="class_c_i___string_alloc.html#a5e54128cdba3ae96b50e5fcdeae9b90b">CI_StringAlloc</a>(<span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString1, <span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString2, <span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString3, <span class="keywordtype">int</span> nAdditional)
<a name="l00088"></a>00088         {
<a name="l00089"></a>00089                 <a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">Alloc</a>((<span class="keywordtype">int</span>)_tcslen(szString1==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString1) + 
<a name="l00090"></a>00090                         (<span class="keywordtype">int</span>)_tcslen(szString2==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString2) + 
<a name="l00091"></a>00091                         (<span class="keywordtype">int</span>)_tcslen(szString3==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString3) + 
<a name="l00092"></a>00092                         nAdditional + 1);
<a name="l00093"></a>00093         }
<a name="l00103"></a><a class="code" href="class_c_i___string_alloc.html#af9cdd420d20d537a009c8459d9398446">00103</a>         <a class="code" href="class_c_i___string_alloc.html#a5e54128cdba3ae96b50e5fcdeae9b90b">CI_StringAlloc</a>(<span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString1, <span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString2, <span class="keywordtype">int</span> nAdditional)
<a name="l00104"></a>00104         {
<a name="l00105"></a>00105                 <a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">Alloc</a>((<span class="keywordtype">int</span>)_tcslen(szString1==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString1) + 
<a name="l00106"></a>00106                         (<span class="keywordtype">int</span>)_tcslen(szString2==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString2) + 
<a name="l00107"></a>00107                         nAdditional + 1);
<a name="l00108"></a>00108         }
<a name="l00117"></a><a class="code" href="class_c_i___string_alloc.html#a6b7bfe4c76983a95858582363386aa1e">00117</a>         <a class="code" href="class_c_i___string_alloc.html#a5e54128cdba3ae96b50e5fcdeae9b90b">CI_StringAlloc</a>(<span class="keyword">const</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString1, <span class="keywordtype">int</span> nAdditional)
<a name="l00118"></a>00118         {
<a name="l00119"></a>00119                 <a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">Alloc</a>((<span class="keywordtype">int</span>)_tcslen(szString1==NULL ? _T(<span class="stringliteral">&quot;(null)&quot;</span>) : szString1)
<a name="l00120"></a>00120                         + nAdditional + 1);
<a name="l00121"></a>00121         }
<a name="l00127"></a><a class="code" href="class_c_i___string_alloc.html#ad08c83b1d4fab7aa93b8142e568beed5">00127</a>         <a class="code" href="class_c_i___string_alloc.html#a5e54128cdba3ae96b50e5fcdeae9b90b">CI_StringAlloc</a>(<span class="keywordtype">int</span> nSize)
<a name="l00128"></a>00128         {
<a name="l00129"></a>00129                 <a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">Alloc</a>(nSize);
<a name="l00130"></a>00130         }
<a name="l00134"></a><a class="code" href="class_c_i___string_alloc.html#a10a1810409fb6f1c1596d349cb4c8e50">00134</a>         <a class="code" href="class_c_i___string_alloc.html#a10a1810409fb6f1c1596d349cb4c8e50">~CI_StringAlloc</a>()
<a name="l00135"></a>00135         {
<a name="l00136"></a>00136                 <span class="keywordflow">if</span>(<a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a>)
<a name="l00137"></a>00137                 {
<a name="l00138"></a>00138                         <span class="keywordflow">if</span>(<a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a>!=<a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">m_szInternal</a>)
<a name="l00139"></a>00139                                 <span class="keyword">delete</span>[] <a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a>;
<a name="l00140"></a>00140                         <a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a> = NULL;
<a name="l00141"></a>00141                         <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a> = 0;
<a name="l00142"></a>00142                 }
<a name="l00143"></a>00143         }
<a name="l00149"></a><a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">00149</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>()
<a name="l00150"></a>00150         {
<a name="l00151"></a>00151                 <span class="keywordflow">return</span> <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a>;
<a name="l00152"></a>00152         }
<a name="l00157"></a><a class="code" href="class_c_i___string_alloc.html#a48a0cf691fdac4b988844ed34656d2b5">00157</a>         <a class="code" href="class_c_i___string_alloc.html#a48a0cf691fdac4b988844ed34656d2b5">operator CI_TCHAR *</a>()<span class="keyword"> const</span>
<a name="l00158"></a>00158 <span class="keyword">        </span>{
<a name="l00159"></a>00159                 <span class="keywordflow">return</span> <a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a>;
<a name="l00160"></a>00160         }
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="keyword">protected</span>:
<a name="l00163"></a><a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">00163</a>         <span class="keywordtype">void</span> <a class="code" href="class_c_i___string_alloc.html#a78e93a0bd981572f4c1e719e363fd17a">Alloc</a>(<span class="keywordtype">int</span> nSize)
<a name="l00164"></a>00164         {       <span class="comment">// by design, only called from contructor</span>
<a name="l00165"></a>00165                 <span class="keywordflow">if</span>(nSize&lt;=<a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(<a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">m_szInternal</a>))
<a name="l00166"></a>00166                 {
<a name="l00167"></a>00167                         <a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a> = <a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">m_szInternal</a>;
<a name="l00168"></a>00168                         <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a> = <a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(<a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">m_szInternal</a>);
<a name="l00169"></a>00169                         <span class="keywordflow">return</span>;
<a name="l00170"></a>00170                 }
<a name="l00171"></a>00171                 <span class="keywordflow">if</span>(<a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a> = <span class="keyword">new</span> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a>[nSize])
<a name="l00172"></a>00172                 {
<a name="l00173"></a>00173                         <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a> = nSize;
<a name="l00174"></a>00174                         <span class="keywordflow">return</span>;
<a name="l00175"></a>00175                 }
<a name="l00176"></a>00176                 <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a> = 0;
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">00179</a>         <span class="keywordtype">int</span> <a class="code" href="class_c_i___string_alloc.html#a12c7df535f50923e3f22f6a370766609">m_nSize</a>;
<a name="l00180"></a><a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">00180</a>         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> <a class="code" href="class_c_i___string_alloc.html#a647b4f5f7a733c6edcdeb4a221bd1100">m_szInternal</a>[256];
<a name="l00181"></a><a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">00181</a>         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *<a class="code" href="class_c_i___string_alloc.html#ab238c8c82e5bc21302562beda51f243f">m_szString</a>;
<a name="l00182"></a>00182 };
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">/* Basic commands */</span>
<a name="l00185"></a>00185 
<a name="l00193"></a><a class="code" href="ci__ctrl__simple_8h.html#ad1aad2fcbb6731daf6fc65159910ebca">00193</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a473f34372146c8fbe86ffb1cb88f1092">CI_HMODULE</a> <a class="code" href="ci__ctrl__simple_8h.html#ad1aad2fcbb6731daf6fc65159910ebca">CI_Simple_LoadLibrary</a>()
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195 <span class="preprocessor">#ifdef STATIC_LINK_SDK</span>
<a name="l00196"></a>00196 <span class="preprocessor"></span>    <span class="keywordflow">return</span> (<a class="code" href="ci__ctrl__type_8h.html#a473f34372146c8fbe86ffb1cb88f1092">CI_HMODULE</a>)_T(<span class="stringliteral">&quot;CiplMgr.dll&quot;</span>);
<a name="l00197"></a>00197 <span class="preprocessor">#else</span>
<a name="l00198"></a>00198 <span class="preprocessor"></span><span class="preprocessor">#if WINAPI_FAMILY_PARTITION(!WINAPI_PARTITION_DESKTOP)</span>
<a name="l00199"></a>00199 <span class="preprocessor"></span>        <span class="keywordflow">return</span> LoadPackagedLibrary(_T(<span class="stringliteral">&quot;CiplMgr.dll&quot;</span>), 0);
<a name="l00200"></a>00200 <span class="preprocessor">#else</span>
<a name="l00201"></a>00201 <span class="preprocessor"></span>        <span class="keywordflow">return</span> LoadLibrary(_T(<span class="stringliteral">&quot;CiplMgr.dll&quot;</span>));
<a name="l00202"></a>00202 <span class="preprocessor">#endif</span>
<a name="l00203"></a>00203 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00204"></a>00204 <span class="preprocessor"></span>}
<a name="l00205"></a>00205 
<a name="l00215"></a><a class="code" href="ci__ctrl__simple_8h.html#a5380968afd0e2ed9dfda0a009f7a206c">00215</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a5380968afd0e2ed9dfda0a009f7a206c">CI_Simple_FreeLibrary</a>(<a class="code" href="ci__ctrl__type_8h.html#a473f34372146c8fbe86ffb1cb88f1092">CI_HMODULE</a> hLib)
<a name="l00216"></a>00216 {
<a name="l00217"></a>00217         <span class="keywordflow">if</span>(hLib==NULL)
<a name="l00218"></a>00218                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00219"></a>00219 <span class="preprocessor">#ifdef STATIC_LINK_SDK</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>    <span class="keywordflow">return</span> S_OK;
<a name="l00221"></a>00221 <span class="preprocessor">#else</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>        <span class="keywordflow">return</span> FreeLibrary(hLib) ? S_OK : E_FAIL;
<a name="l00223"></a>00223 <span class="preprocessor">#endif</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>}
<a name="l00225"></a>00225 
<a name="l00240"></a><a class="code" href="ci__ctrl__simple_8h.html#a738dfc7b9860c7b4b1fc2ebcaf0bec05">00240</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a738dfc7b9860c7b4b1fc2ebcaf0bec05">CI_Simple_CreateManager</a>(<a class="code" href="ci__ctrl__type_8h.html#a473f34372146c8fbe86ffb1cb88f1092">CI_HMODULE</a> hLib, <a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> **ppHandle)
<a name="l00241"></a>00241 {
<a name="l00242"></a>00242         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l00243"></a>00243         <a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *pMgr;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="keywordflow">if</span>(ppHandle==NULL || hLib==NULL)
<a name="l00246"></a>00246                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00247"></a>00247 <span class="preprocessor">#ifdef STATIC_LINK_SDK</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>    hr = <a class="code" href="_cipl_mgr_8cpp.html#aa0ca88134be1b597ee205df4bfb88f70">CoCreateCiplManager</a>(<a class="code" href="_cipl_mgr_8h.html#a3a08fb009e2324fc7e8fb75089454096">CLSID_CiplCtlMgr</a>,NULL,NULL,<a class="code" href="_cipl_mgr_8h.html#a173ed6fd37f1eafd1a4e82fc3ad768ac">IID_ICiplCtlMgr</a>,(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> **)&amp;pMgr);
<a name="l00249"></a>00249 <span class="preprocessor">#else</span>
<a name="l00250"></a>00250 <span class="preprocessor"></span>        <a class="code" href="_cipl_mgr_8h.html#aafdb1f993f46f2f8b107b8f09d7b8085">LPFN_CoCreateCiplManager</a> pCoCreateCiplManager;
<a name="l00251"></a>00251 <span class="preprocessor">#ifdef WINCE</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>        pCoCreateCiplManager = (<a class="code" href="_cipl_mgr_8h.html#aafdb1f993f46f2f8b107b8f09d7b8085">LPFN_CoCreateCiplManager</a>) GetProcAddress(hLib,_T(<span class="stringliteral">&quot;CoCreateCiplManager&quot;</span>));
<a name="l00253"></a>00253 <span class="preprocessor">#else</span>
<a name="l00254"></a>00254 <span class="preprocessor"></span>        pCoCreateCiplManager = (<a class="code" href="_cipl_mgr_8h.html#aafdb1f993f46f2f8b107b8f09d7b8085">LPFN_CoCreateCiplManager</a>) GetProcAddress(hLib,<span class="stringliteral">&quot;CoCreateCiplManager&quot;</span>);
<a name="l00255"></a>00255 <span class="preprocessor">#endif</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(pCoCreateCiplManager==NULL)
<a name="l00257"></a>00257                 <span class="keywordflow">return</span> E_FAIL;
<a name="l00258"></a>00258         hr = (*pCoCreateCiplManager)(<a class="code" href="_cipl_mgr_8h.html#a3a08fb009e2324fc7e8fb75089454096">CLSID_CiplCtlMgr</a>,NULL,NULL,<a class="code" href="_cipl_mgr_8h.html#a173ed6fd37f1eafd1a4e82fc3ad768ac">IID_ICiplCtlMgr</a>,(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> **)&amp;pMgr);
<a name="l00259"></a>00259 <span class="preprocessor">#endif</span>
<a name="l00260"></a>00260 <span class="preprocessor"></span>        <span class="keywordflow">if</span>(FAILED(hr))
<a name="l00261"></a>00261                 <span class="keywordflow">return</span> hr;
<a name="l00262"></a>00262         *ppHandle = pMgr;
<a name="l00263"></a>00263         <span class="keywordflow">return</span> S_OK;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00276"></a><a class="code" href="ci__ctrl__simple_8h.html#a12d1449d6e1ec3ec3df75157787c512b">00276</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> <a class="code" href="ci__ctrl__simple_8h.html#a12d1449d6e1ec3ec3df75157787c512b">CI_Simple_DestroyManager</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle)
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l00279"></a>00279         <a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *pMgr;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00282"></a>00282                 <span class="keywordflow">return</span> 0;
<a name="l00283"></a>00283         pMgr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle);
<a name="l00284"></a>00284         hr = pMgr-&gt;<a class="code" href="struct_i_cipl_ctl_mgr.html#ab07840ae199e4302d436bd079704c87e">Close</a>();
<a name="l00285"></a>00285         <span class="keywordflow">return</span> pMgr-&gt;Release();
<a name="l00286"></a>00286 }
<a name="l00287"></a>00287 
<a name="l00301"></a><a class="code" href="ci__ctrl__simple_8h.html#a6faa2749a01d2a530fc6048ee2912b35">00301</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a6faa2749a01d2a530fc6048ee2912b35">CI_Simple_OpenManager</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32OpenFlags, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32EscChar)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l00304"></a>00304         <a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *pMgr;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00307"></a>00307                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00308"></a>00308         pMgr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle);
<a name="l00309"></a>00309         hr = pMgr-&gt;<a class="code" href="struct_i_cipl_ctl_mgr.html#a68502591728e32049f9166f43f46f783">Open</a>(u32OpenFlags, u32EscChar);
<a name="l00310"></a>00310         <span class="keywordflow">return</span> hr;
<a name="l00311"></a>00311 }
<a name="l00312"></a>00312 
<a name="l00322"></a><a class="code" href="ci__ctrl__simple_8h.html#ae03f5bf612f7f9b46bd31c3f42c7630f">00322</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ae03f5bf612f7f9b46bd31c3f42c7630f">CI_Simple_CloseManager</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle)
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l00325"></a>00325         <a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *pMgr;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00328"></a>00328                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00329"></a>00329         pMgr = <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle);
<a name="l00330"></a>00330         hr = pMgr-&gt;<a class="code" href="struct_i_cipl_ctl_mgr.html#ab07840ae199e4302d436bd079704c87e">Close</a>();
<a name="l00331"></a>00331         <span class="keywordflow">return</span> hr;
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00348"></a><a class="code" href="ci__ctrl__simple_8h.html#adb895376bcf8bfa30d472b3c49b27612">00348</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#adb895376bcf8bfa30d472b3c49b27612">CI_Simple_CreateSession</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, DWORD dwFlags)
<a name="l00349"></a>00349 {
<a name="l00350"></a>00350         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00351"></a>00351                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00352"></a>00352         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;CreateObject(<a class="code" href="_cipl_mgr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4410adcf607a07c6d0ed86f614b6194d">CIPLCTLMGR_OBJECT_TYPE_SESSION</a>,szSession, dwFlags);
<a name="l00353"></a>00353 }
<a name="l00354"></a>00354 
<a name="l00365"></a><a class="code" href="ci__ctrl__simple_8h.html#a55dd1f5f4cf4a1d6f7d433d79f3e6ccf">00365</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a55dd1f5f4cf4a1d6f7d433d79f3e6ccf">CI_Simple_DestroySession</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00366"></a>00366 {
<a name="l00367"></a>00367         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00368"></a>00368                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00369"></a>00369         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;DestroyObject(<a class="code" href="_cipl_mgr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a4410adcf607a07c6d0ed86f614b6194d">CIPLCTLMGR_OBJECT_TYPE_SESSION</a>,szSession);
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00387"></a><a class="code" href="ci__ctrl__simple_8h.html#ad0dbb775ac34aed6cb0b8aceb94f1ca7">00387</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ad0dbb775ac34aed6cb0b8aceb94f1ca7">CI_Simple_SelectSession</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00388"></a>00388 {
<a name="l00389"></a>00389         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00390"></a>00390                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00391"></a>00391         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szSession,+16);
<a name="l00392"></a>00392 
<a name="l00393"></a>00393         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00394"></a>00394                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00395"></a>00395         <span class="keywordflow">if</span>(szSession)
<a name="l00396"></a>00396                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;select session &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a>,szSession);
<a name="l00397"></a>00397         <span class="keywordflow">else</span>
<a name="l00398"></a>00398                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;select session&quot;</span>));
<a name="l00399"></a>00399         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00400"></a>00400 }
<a name="l00401"></a>00401 
<a name="l00415"></a><a class="code" href="ci__ctrl__simple_8h.html#af91e43e544ca56241496deda58139480">00415</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#af91e43e544ca56241496deda58139480">CI_Simple_SelectWindow</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a20ff799aeecbf18c6137a01d574246be">CI_HWND</a> hWnd)
<a name="l00416"></a>00416 {
<a name="l00417"></a>00417         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00418"></a>00418                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00419"></a>00419         <a class="code" href="struct_c_i_p_l___window_item.html">CIPL_WindowItem</a> wndIt = {NULL, hWnd};
<a name="l00420"></a>00420         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;SelectExternalObject(szSession,<a class="code" href="_cipl_mgr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a0ce8abb01c77a675eabe9899a16cc883">CIPLCTLMGR_OBJECT_TYPE_WINDOW</a>,&amp;wndIt);
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00436"></a><a class="code" href="ci__ctrl__simple_8h.html#a50dfe4a0d4fe52e97388b8486dfc4c9b">00436</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#af91e43e544ca56241496deda58139480">CI_Simple_SelectWindow</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szWindowName)
<a name="l00437"></a>00437 {
<a name="l00438"></a>00438         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00439"></a>00439                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00440"></a>00440         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;SelectObject(szSession,<a class="code" href="_cipl_mgr_8h.html#adf764cbdea00d65edcd07bb9953ad2b7a0ce8abb01c77a675eabe9899a16cc883">CIPLCTLMGR_OBJECT_TYPE_WINDOW</a>,szWindowName);
<a name="l00441"></a>00441 }
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">/*</span>
<a name="l00444"></a>00444 <span class="comment">*/</span>
<a name="l00445"></a>00445 
<a name="l00468"></a><a class="code" href="ci__ctrl__simple_8h.html#a71beee8a0caa2d7e8c22032ead8aaae0">00468</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a71beee8a0caa2d7e8c22032ead8aaae0">CI_Simple_OpenSource</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szPath, 
<a name="l00469"></a>00469                                       <a class="code" href="ci__ctrl__type_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szReturn = NULL, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> ccReturn = 0, <a class="code" href="ci__ctrl__type_8h.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pccFilled = NULL)
<a name="l00470"></a>00470 {
<a name="l00471"></a>00471         <span class="keywordflow">if</span>(pHandle==NULL || szType==NULL || szPath==NULL)
<a name="l00472"></a>00472                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00473"></a>00473         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,szPath,+16);
<a name="l00474"></a>00474 
<a name="l00475"></a>00475         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00476"></a>00476                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00477"></a>00477         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;open &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; \&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>),szType,szPath); <span class="comment">// [Edmond] Add quotation mark for file name may contain space characters.</span>
<a name="l00478"></a>00478         <span class="keywordflow">if</span> (pccFilled)  <span class="comment">// [Edmond] intial filled size to zero</span>
<a name="l00479"></a>00479                 *pccFilled = 0;
<a name="l00480"></a>00480         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szReturn, ccReturn, pccFilled);
<a name="l00481"></a>00481 }
<a name="l00482"></a>00482 
<a name="l00502"></a><a class="code" href="ci__ctrl__simple_8h.html#a594d87c2708ff144b75e44b2eea21c93">00502</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a594d87c2708ff144b75e44b2eea21c93">CI_Simple_CloseSource</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType = NULL, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szPath = NULL)
<a name="l00503"></a>00503 {
<a name="l00504"></a>00504         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00505"></a>00505                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00506"></a>00506         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,szPath,+17);
<a name="l00507"></a>00507 
<a name="l00508"></a>00508         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00509"></a>00509                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00510"></a>00510         <span class="keywordflow">if</span> (szType)
<a name="l00511"></a>00511                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;close &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; \&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>),szType,szPath);        <span class="comment">// [Edmond] Add quotation mark for file name may contain space characters.</span>
<a name="l00512"></a>00512         <span class="keywordflow">else</span>
<a name="l00513"></a>00513                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;close&quot;</span>));
<a name="l00514"></a>00514         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00515"></a>00515 }
<a name="l00516"></a>00516 
<a name="l00531"></a><a class="code" href="ci__ctrl__simple_8h.html#ac0e14c28b42829cfd5f9de1ca51029a1">00531</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ac0e14c28b42829cfd5f9de1ca51029a1">CI_Simple_Play</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00532"></a>00532 {
<a name="l00533"></a>00533         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00534"></a>00534                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00535"></a>00535         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, _T(<span class="stringliteral">&quot;play&quot;</span>));
<a name="l00536"></a>00536 }
<a name="l00537"></a>00537 
<a name="l00551"></a><a class="code" href="ci__ctrl__simple_8h.html#a90d5fd78ef53a32121c764cb82565e89">00551</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a90d5fd78ef53a32121c764cb82565e89">CI_Simple_Pause</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00554"></a>00554                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00555"></a>00555         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, _T(<span class="stringliteral">&quot;pause&quot;</span>));
<a name="l00556"></a>00556 }
<a name="l00557"></a>00557 
<a name="l00571"></a><a class="code" href="ci__ctrl__simple_8h.html#a9e7111665e752eb96d9bd168995148f9">00571</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a9e7111665e752eb96d9bd168995148f9">CI_Simple_Resume</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00572"></a>00572 {
<a name="l00573"></a>00573         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00574"></a>00574                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00575"></a>00575         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, _T(<span class="stringliteral">&quot;resume&quot;</span>));
<a name="l00576"></a>00576 }
<a name="l00577"></a>00577 
<a name="l00595"></a><a class="code" href="ci__ctrl__simple_8h.html#a76c1da9106e9306755d009bd4023ec2c">00595</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a76c1da9106e9306755d009bd4023ec2c">CI_Simple_Start</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szService, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szFilename = NULL)
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00598"></a>00598                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00599"></a>00599         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szService,szFilename,16);
<a name="l00600"></a>00600 
<a name="l00601"></a>00601         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00602"></a>00602                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00603"></a>00603         <span class="keywordflow">if</span>(szFilename)
<a name="l00604"></a>00604                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;start &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; \&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>),szService,szFilename);
<a name="l00605"></a>00605         <span class="keywordflow">else</span>
<a name="l00606"></a>00606                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;start &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a>,szService);
<a name="l00607"></a>00607         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00608"></a>00608 }
<a name="l00609"></a>00609 
<a name="l00626"></a><a class="code" href="ci__ctrl__simple_8h.html#abc12e56bfacc60b6a6888a00ec1d0f01">00626</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#abc12e56bfacc60b6a6888a00ec1d0f01">CI_Simple_Stop</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szService = NULL)
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00629"></a>00629                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00630"></a>00630         <span class="keywordflow">if</span>(szService==NULL)             <span class="comment">// just stop playback</span>
<a name="l00631"></a>00631                 <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, _T(<span class="stringliteral">&quot;stop&quot;</span>));
<a name="l00632"></a>00632         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szService,szService,16);
<a name="l00633"></a>00633         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;stop &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szService);
<a name="l00634"></a>00634         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00635"></a>00635 }
<a name="l00636"></a>00636 
<a name="l00653"></a><a class="code" href="ci__ctrl__simple_8h.html#af4b72496a7142bf41b9bc9c3ba3a6ff3">00653</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#af4b72496a7142bf41b9bc9c3ba3a6ff3">CI_Simple_StartScanFrequency</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32StartKhz, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32EndKhz, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32BandwidthKhz)
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00656"></a>00656                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00657"></a>00657         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00660"></a>00660                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00661"></a>00661         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startscan %d %d %d&quot;</span>),s32StartKhz, s32EndKhz, s32BandwidthKhz);
<a name="l00662"></a>00662         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00663"></a>00663 }
<a name="l00664"></a>00664 
<a name="l00681"></a><a class="code" href="ci__ctrl__simple_8h.html#accfe3da20af87cffb75a09c513ee4c2b">00681</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#accfe3da20af87cffb75a09c513ee4c2b">CI_Simple_StartReScanFrequency</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32StartKhz, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32EndKhz, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32BandwidthKhz)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00684"></a>00684                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00685"></a>00685         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l00686"></a>00686 
<a name="l00687"></a>00687         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00688"></a>00688                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00689"></a>00689         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startrescan %d %d %d&quot;</span>),s32StartKhz, s32EndKhz, s32BandwidthKhz);
<a name="l00690"></a>00690         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00691"></a>00691 }
<a name="l00692"></a>00692 
<a name="l00708"></a><a class="code" href="ci__ctrl__simple_8h.html#a7b0d64a2f2c8d54c49dbbbd541a3cc54">00708</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a7b0d64a2f2c8d54c49dbbbd541a3cc54">CI_Simple_StartScanRegion</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32CountryCode, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32RegionID)
<a name="l00709"></a>00709 {
<a name="l00710"></a>00710         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00711"></a>00711                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00712"></a>00712         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l00713"></a>00713 
<a name="l00714"></a>00714         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00715"></a>00715                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00716"></a>00716         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startscan region %d %d&quot;</span>), u32CountryCode, u32RegionID);
<a name="l00717"></a>00717         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00718"></a>00718 }
<a name="l00719"></a>00719 
<a name="l00735"></a><a class="code" href="ci__ctrl__simple_8h.html#a68f13b92d0e32e82b2f3994e243bde74">00735</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a68f13b92d0e32e82b2f3994e243bde74">CI_Simple_StartReScanRegion</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32CountryCode, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32RegionID)
<a name="l00736"></a>00736 {
<a name="l00737"></a>00737         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00738"></a>00738                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00739"></a>00739         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l00740"></a>00740 
<a name="l00741"></a>00741         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00742"></a>00742                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00743"></a>00743         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startrescan region %d %d&quot;</span>), u32CountryCode, u32RegionID);
<a name="l00744"></a>00744         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00745"></a>00745 }
<a name="l00746"></a>00746 
<a name="l00761"></a><a class="code" href="ci__ctrl__simple_8h.html#addb7279cdb7f4caa56370088e5c700e9">00761</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#addb7279cdb7f4caa56370088e5c700e9">CI_Simple_StartScanFile</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szFileName)
<a name="l00762"></a>00762 {
<a name="l00763"></a>00763         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00764"></a>00764                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00765"></a>00765         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(MAX_PATH+20);
<a name="l00766"></a>00766 
<a name="l00767"></a>00767         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startscan file &quot;</span>) _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>),szFileName);
<a name="l00768"></a>00768 
<a name="l00769"></a>00769         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00770"></a>00770 }
<a name="l00771"></a>00771 
<a name="l00772"></a>00772 
<a name="l00787"></a><a class="code" href="ci__ctrl__simple_8h.html#ac534bb4883ebec00cc834c6dc47cc789">00787</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ac534bb4883ebec00cc834c6dc47cc789">CI_Simple_StartScanUrl</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szFileName)
<a name="l00788"></a>00788 {
<a name="l00789"></a>00789         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00790"></a>00790                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00791"></a>00791         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand((<span class="keywordtype">int</span>)_tcslen(szFileName)+20);
<a name="l00792"></a>00792 
<a name="l00793"></a>00793         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;startscan url &quot;</span>) _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>),szFileName);
<a name="l00794"></a>00794 
<a name="l00795"></a>00795         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00796"></a>00796 }
<a name="l00797"></a>00797 
<a name="l00809"></a><a class="code" href="ci__ctrl__simple_8h.html#a508e45c0608027d457912c5844582af1">00809</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a508e45c0608027d457912c5844582af1">CI_Simple_StopScan</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l00810"></a>00810 {
<a name="l00811"></a>00811         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00812"></a>00812                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00813"></a>00813         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, _T(<span class="stringliteral">&quot;stopscan&quot;</span>));
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00830"></a><a class="code" href="ci__ctrl__simple_8h.html#ab8757abefe124a6f1d840eef12fe794e">00830</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ab8757abefe124a6f1d840eef12fe794e">CI_Simple_WaitFor</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Msec = (<a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a>)-1)
<a name="l00831"></a>00831 {
<a name="l00832"></a>00832 
<a name="l00833"></a>00833         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l00834"></a>00834                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00835"></a>00835         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,32);
<a name="l00836"></a>00836 
<a name="l00837"></a>00837         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00838"></a>00838                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00839"></a>00839         <span class="keywordflow">if</span>(s32Msec==-1)
<a name="l00840"></a>00840                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;wait &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szType);
<a name="l00841"></a>00841         <span class="keywordflow">else</span>
<a name="l00842"></a>00842                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;wait &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>),szType,s32Msec);
<a name="l00843"></a>00843         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00844"></a>00844 }
<a name="l00845"></a>00845 
<a name="l00866"></a><a class="code" href="ci__ctrl__simple_8h.html#acc3c961620d867f9460a6444446dcf55">00866</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#acc3c961620d867f9460a6444446dcf55">CI_Simple_Select</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Index)
<a name="l00867"></a>00867 {
<a name="l00868"></a>00868         <span class="keywordflow">if</span>(pHandle==NULL || szType==NULL)
<a name="l00869"></a>00869                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00870"></a>00870         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,32);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00873"></a>00873                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00874"></a>00874         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;select &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>),szType,s32Index);
<a name="l00875"></a>00875         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878 <span class="comment">/*</span>
<a name="l00879"></a>00879 <span class="comment">        get | set                       // the set takes an integer value unless otherwise specified.</span>
<a name="l00880"></a>00880 <span class="comment">                &quot;position&quot;              // G + S                        : current file position</span>
<a name="l00881"></a>00881 <span class="comment">                &quot;duration&quot;              // G                            : length of file in msec</span>
<a name="l00882"></a>00882 <span class="comment">                &quot;volume&quot;                // G + S + R + A        : volume level</span>
<a name="l00883"></a>00883 <span class="comment">                &quot;mute&quot;                  // G + S                        : mute, 0 = audio, 1 = muted (no audio)</span>
<a name="l00884"></a>00884 <span class="comment">                &quot;tsposition&quot;    // G + S                        : timeshift postion</span>
<a name="l00885"></a>00885 <span class="comment">                &quot;tsduration&quot;    // G                            : timeshift duration</span>
<a name="l00886"></a>00886 <span class="comment">                &quot;tsrange&quot;               // G + S                        : timeshift range</span>
<a name="l00887"></a>00887 <span class="comment">                &quot;scan&quot;          // G + S            : trick mode speed</span>
<a name="l00888"></a>00888 <span class="comment">                &quot;contrast&quot;              // G + S + R + A        : video contrast</span>
<a name="l00889"></a>00889 <span class="comment">                &quot;brightness&quot;    // G + S + R + A        : video brightness</span>
<a name="l00890"></a>00890 <span class="comment">                &quot;hue&quot;                   // G + S + R + A        : video hue</span>
<a name="l00891"></a>00891 <span class="comment">                &quot;saturation&quot;    // G + S + R + A        : video saturation</span>
<a name="l00892"></a>00892 <span class="comment">                &quot;gamma&quot;                 // G + S + R + A        : video gamma</span>
<a name="l00893"></a>00893 <span class="comment">                &quot;display&quot;               // G + S                        : display mode</span>
<a name="l00894"></a>00894 <span class="comment">                        &quot;stretch&quot; | &quot;letterbox&quot; | &quot;crop&quot;</span>
<a name="l00895"></a>00895 <span class="comment">                &quot;video&quot;                 // G + S                        : 1 means video is on, 0 means video is off</span>
<a name="l00896"></a>00896 <span class="comment">                &quot;videofunc&quot;     // G + S            : 1 means video function is on, 0 means video function is off</span>
<a name="l00897"></a>00897 <span class="comment">                &quot;subititle&quot;     // G + S            : 1 means subtitle is on, 0 means subtitle is off</span>
<a name="l00898"></a>00898 <span class="comment">                &quot;pcm&quot;           // G + S            : 1 means audio pcm is on, 0 means off</span>
<a name="l00899"></a>00899 <span class="comment">                &quot;spectrum&quot;      // G + S            : 1 means audio spectrum analysis is on, 0 means off</span>
<a name="l00900"></a>00900 <span class="comment">                &quot;audiomode&quot;             // G + S                        : audio channel mode</span>
<a name="l00901"></a>00901 <span class="comment">                &quot;stereo&quot; | &quot;left&quot; | &quot;right&quot;</span>
<a name="l00902"></a>00902 <span class="comment">                &quot;parentalcontent&quot;// G + S + M           : parental control content block, can be multiple select, separated by &#39;|&#39;</span>
<a name="l00903"></a>00903 <span class="comment">                        &quot;none&quot; | &quot;drugs&quot; | &quot;violence&quot; | &quot;sex&quot;</span>
<a name="l00904"></a>00904 <span class="comment">                &quot;parentalage&quot;   // G + S                        : parental control age level</span>
<a name="l00905"></a>00905 <span class="comment">                &quot;equalization&quot;  // G + S                        : equalization preset effect mode</span>
<a name="l00906"></a>00906 <span class="comment">                        &quot;normal&quot; | &quot;pop&quot; | &quot;hiphop&quot; | &quot;rap&quot; | &quot;grunge&quot; | &quot;jazz&quot; | &quot;rock&amp;roll&quot; | &quot;metal&quot; | &quot;dance&quot; | &quot;techno&quot; | &quot;classical&quot; | &quot;electronic&quot; | </span>
<a name="l00907"></a>00907 <span class="comment">                        &quot;newage&quot; | &quot;folk&quot; | &quot;country&quot; | &quot;randb&quot; | &quot;blues&quot; | &quot;easylisten&quot; | &quot;oldies&quot; | &quot;reggae&quot; | &quot;opera&quot; | &quot;swing&quot; | &quot;speech&quot; | &quot;acoustic&quot;)</span>
<a name="l00908"></a>00908 <span class="comment">                &quot;equalization&quot;  // AR                           : equalization gain value</span>
<a name="l00909"></a>00909 <span class="comment">                &quot;timemode&quot;              // G + S                        : use stream time system(1) or local time system(0)</span>
<a name="l00910"></a>00910 <span class="comment">                &quot;recordspace&quot;   // G + S                        : disk space limitation in MBs</span>
<a name="l00911"></a>00911 <span class="comment">                &quot;devicebattmode&quot;// G + S                        : device use battery switch</span>
<a name="l00912"></a>00912 <span class="comment">                        &quot;internal&quot; | &quot;external&quot;</span>
<a name="l00913"></a>00913 <span class="comment">                &quot;videorect&quot;             // AR                           : video display rectangle, format is &quot;videorect left top right bottom&quot;</span>
<a name="l00914"></a>00914 <span class="comment">                &quot;interactwndrect&quot;       // AR                   : interactive window display rectangle, format is &quot;interactwndrect left top right bottom&quot;</span>
<a name="l00915"></a>00915 <span class="comment"></span>
<a name="l00916"></a>00916 <span class="comment">        get | set                       // the set takes an string value unless otherwise specified.</span>
<a name="l00917"></a>00917 <span class="comment">                &quot;recordpath&quot;    // G + S                        : directory for record files</span>
<a name="l00918"></a>00918 <span class="comment">                &quot;snapshotpath&quot;  // G + S                        : directory for snapshot files</span>
<a name="l00919"></a>00919 <span class="comment">                &quot;tspath&quot;                // G + S                        : directory for ts files</span>
<a name="l00920"></a>00920 <span class="comment">                &quot;syscachepath&quot;  // G + S                        : directory for system cache path</span>
<a name="l00921"></a>00921 <span class="comment">                &quot;mediainfopath&quot; // G + S                        : directory for media information cache files</span>
<a name="l00922"></a>00922 <span class="comment">                &quot;writablepath&quot;  // G + S                        : directory for component read/write files/cache</span>
<a name="l00923"></a>00923 <span class="comment"></span>
<a name="l00924"></a>00924 <span class="comment">        get</span>
<a name="l00925"></a>00925 <span class="comment">                &quot;ndevice&quot;                               // G            : number of devices</span>
<a name="l00926"></a>00926 <span class="comment">                &quot;nservice&quot;                              // G            : number of services</span>
<a name="l00927"></a>00927 <span class="comment">                &quot;cdevice&quot;                               // G            : current device</span>
<a name="l00928"></a>00928 <span class="comment">                &quot;cservice&quot;                              // G            : current service</span>
<a name="l00929"></a>00929 <span class="comment">        &quot;cservicefreq&quot;          // G        : current service frequency, in KHz</span>
<a name="l00930"></a>00930 <span class="comment">                &quot;uop&quot;                                   // G            : user operation (bitfield)</span>
<a name="l00931"></a>00931 <span class="comment">                &quot;uopmax&quot;                                // G            : maximum user operations supported by source</span>
<a name="l00932"></a>00932 <span class="comment">                &quot;state&quot;                                 // G            : current playback state</span>
<a name="l00933"></a>00933 <span class="comment">                &quot;id3&quot;                                   // G            : complex id3 string blob structure.</span>
<a name="l00934"></a>00934 <span class="comment">                &quot;standard&quot;                              // G            : standard of source</span>
<a name="l00935"></a>00935 <span class="comment">                &quot;origin&quot;                                // G            : origin type of source</span>
<a name="l00936"></a>00936 <span class="comment">                &quot;audioinfo&quot;                             // G            : audio codec information</span>
<a name="l00937"></a>00937 <span class="comment">                &quot;videoinfo&quot;                             // G            : video codec information</span>
<a name="l00938"></a>00938 <span class="comment">                &quot;csubtitle&quot;                             // G            : current subtitle index, -1 is no subtitle selected</span>
<a name="l00939"></a>00939 <span class="comment">                &quot;caudio&quot;                                // G            : current audio index</span>
<a name="l00940"></a>00940 <span class="comment">                &quot;devicebattery&quot;                 // G            : battery information of current </span>
<a name="l00941"></a>00941 <span class="comment">                &quot;signal_test_freq&quot;          // G                : signal test frequency, 0 means NO frequency is in testing</span>
<a name="l00942"></a>00942 <span class="comment"></span>
<a name="l00943"></a>00943 <span class="comment">        G = get supported</span>
<a name="l00944"></a>00944 <span class="comment">        S = set supported</span>
<a name="l00945"></a>00945 <span class="comment">        R = getrange supported</span>
<a name="l00946"></a>00946 <span class="comment">        A = adjust supported</span>
<a name="l00947"></a>00947 <span class="comment">        M = multiple selection supported</span>
<a name="l00948"></a>00948 <span class="comment">        AR = array supported, following included</span>
<a name="l00949"></a>00949 <span class="comment">        ARR = array range supported</span>
<a name="l00950"></a>00950 <span class="comment">        ARN = array number supported</span>
<a name="l00951"></a>00951 <span class="comment">        ARL = array label supported</span>
<a name="l00952"></a>00952 <span class="comment">        ARI = array index supported</span>
<a name="l00953"></a>00953 <span class="comment"></span>
<a name="l00954"></a>00954 <span class="comment">        get returns an integer in s32Value.</span>
<a name="l00955"></a>00955 <span class="comment">        s32Value is only updated on a successful return. </span>
<a name="l00956"></a>00956 <span class="comment">*/</span>
<a name="l00957"></a>00957 
<a name="l00971"></a><a class="code" href="ci__ctrl__simple_8h.html#ac311c367feaa9ab7cd33ff72ac4d23ff">00971</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ac311c367feaa9ab7cd33ff72ac4d23ff">CI_Simple_Get</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32Value)
<a name="l00972"></a>00972 {
<a name="l00973"></a>00973         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l00974"></a>00974         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> szReturn[32];
<a name="l00975"></a>00975 
<a name="l00976"></a>00976         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l00977"></a>00977                 <span class="keywordflow">return</span> E_POINTER;
<a name="l00978"></a>00978         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l00979"></a>00979 
<a name="l00980"></a>00980         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l00981"></a>00981                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l00982"></a>00982         szReturn[0] = 0;
<a name="l00983"></a>00983         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;get &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l00984"></a>00984         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szReturn, <a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(szReturn))))
<a name="l00985"></a>00985                 <span class="keywordflow">return</span> hr;
<a name="l00986"></a>00986         s32Value = _ttoi(szReturn);     <span class="comment">// (no check for legitimate integer return)</span>
<a name="l00987"></a>00987         <span class="keywordflow">return</span> S_OK;
<a name="l00988"></a>00988 }
<a name="l00989"></a>00989 
<a name="l01005"></a><a class="code" href="ci__ctrl__simple_8h.html#a2475b2ba99ee80891d0ee6374d9b27fe">01005</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ac311c367feaa9ab7cd33ff72ac4d23ff">CI_Simple_Get</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01006"></a>01006 {
<a name="l01007"></a>01007         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01008"></a>01008 
<a name="l01009"></a>01009         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01010"></a>01010                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01011"></a>01011         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01012"></a>01012 
<a name="l01013"></a>01013         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01014"></a>01014                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01015"></a>01015         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01016"></a>01016                 szString[0] = 0;
<a name="l01017"></a>01017         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;get &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l01018"></a>01018         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01019"></a>01019                 <span class="keywordflow">return</span> hr;
<a name="l01020"></a>01020         <span class="keywordflow">return</span> S_OK;
<a name="l01021"></a>01021 }
<a name="l01022"></a>01022 
<a name="l01036"></a><a class="code" href="ci__ctrl__simple_8h.html#ad90678d765a654128cacc7e98ace10fb">01036</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ad90678d765a654128cacc7e98ace10fb">CI_Simple_Set</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Value)
<a name="l01037"></a>01037 {
<a name="l01038"></a>01038         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01039"></a>01039                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01040"></a>01040         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp, 32+16);
<a name="l01041"></a>01041 
<a name="l01042"></a>01042         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01043"></a>01043                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01044"></a>01044         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;set &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>),szProp, s32Value);
<a name="l01045"></a>01045         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01046"></a>01046 }
<a name="l01047"></a>01047 
<a name="l01061"></a><a class="code" href="ci__ctrl__simple_8h.html#a83f29f7bef1ea81c4ae59ecd9edf0f51">01061</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ad90678d765a654128cacc7e98ace10fb">CI_Simple_Set</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString)
<a name="l01062"></a>01062 {
<a name="l01063"></a>01063         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL || szString==NULL)
<a name="l01064"></a>01064                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01065"></a>01065         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,szString,16);
<a name="l01066"></a>01066 
<a name="l01067"></a>01067         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01068"></a>01068                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01069"></a>01069         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;set &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; \&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) ,szProp, szString);
<a name="l01070"></a>01070         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01071"></a>01071 }
<a name="l01072"></a>01072 
<a name="l01088"></a><a class="code" href="ci__ctrl__simple_8h.html#a07c5ff7d253466342fbfd2b5ed29c113">01088</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a07c5ff7d253466342fbfd2b5ed29c113">CI_Simple_GetRange</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32ValueMin, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32ValueMax, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32ValueDefault)
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090         <span class="keywordtype">int</span> n;
<a name="l01091"></a>01091         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01092"></a>01092         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> szReturn[96];
<a name="l01093"></a>01093 
<a name="l01094"></a>01094         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01095"></a>01095                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01096"></a>01096         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01097"></a>01097 
<a name="l01098"></a>01098         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01099"></a>01099                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01100"></a>01100         szReturn[0] = 0;
<a name="l01101"></a>01101         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;getrange &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l01102"></a>01102         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szReturn, <a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(szReturn))))
<a name="l01103"></a>01103                 <span class="keywordflow">return</span> hr;
<a name="l01104"></a>01104         n = _stscanf(szReturn,_T(<span class="stringliteral">&quot;%d %d %d&quot;</span>),&amp;s32ValueMin, &amp;s32ValueMax, &amp;s32ValueDefault);
<a name="l01105"></a>01105         <span class="keywordflow">return</span> n==3 ? S_OK : E_FAIL;
<a name="l01106"></a>01106 }
<a name="l01107"></a>01107 
<a name="l01123"></a><a class="code" href="ci__ctrl__simple_8h.html#a1c3ef695591b0251c744489289abe424">01123</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a1c3ef695591b0251c744489289abe424">CI_Simple_GetArrNum</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01124"></a>01124 {
<a name="l01125"></a>01125         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01126"></a>01126 
<a name="l01127"></a>01127         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01128"></a>01128                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01129"></a>01129         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01130"></a>01130 
<a name="l01131"></a>01131         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01132"></a>01132                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01133"></a>01133         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01134"></a>01134                 szString[0] = 0;
<a name="l01135"></a>01135         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;getarraynum &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l01136"></a>01136         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01137"></a>01137                 <span class="keywordflow">return</span> hr;
<a name="l01138"></a>01138         <span class="keywordflow">return</span> S_OK;
<a name="l01139"></a>01139 }
<a name="l01140"></a>01140 
<a name="l01156"></a><a class="code" href="ci__ctrl__simple_8h.html#ab7989e0fe7362634a897d74e88d0b904">01156</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ab7989e0fe7362634a897d74e88d0b904">CI_Simple_GetArrLabels</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01159"></a>01159 
<a name="l01160"></a>01160         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01161"></a>01161                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01162"></a>01162         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01163"></a>01163 
<a name="l01164"></a>01164         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01165"></a>01165                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01166"></a>01166         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01167"></a>01167                 szString[0] = 0;
<a name="l01168"></a>01168         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;getarraylabels &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l01169"></a>01169         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01170"></a>01170                 <span class="keywordflow">return</span> hr;
<a name="l01171"></a>01171         <span class="keywordflow">return</span> S_OK;
<a name="l01172"></a>01172 }
<a name="l01173"></a>01173 
<a name="l01189"></a><a class="code" href="ci__ctrl__simple_8h.html#a78f0995338d806009585e09f2c885b43">01189</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a78f0995338d806009585e09f2c885b43">CI_Simple_GetArray</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01190"></a>01190 {
<a name="l01191"></a>01191         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01192"></a>01192 
<a name="l01193"></a>01193         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01194"></a>01194                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01195"></a>01195         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01196"></a>01196 
<a name="l01197"></a>01197         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01198"></a>01198                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01199"></a>01199         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01200"></a>01200                 szString[0] = 0;
<a name="l01201"></a>01201         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;getarray &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp);
<a name="l01202"></a>01202         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01203"></a>01203                 <span class="keywordflow">return</span> hr;
<a name="l01204"></a>01204         <span class="keywordflow">return</span> S_OK;
<a name="l01205"></a>01205 }
<a name="l01206"></a>01206 
<a name="l01220"></a><a class="code" href="ci__ctrl__simple_8h.html#ac048de75b88caa4883f8c20183f68084">01220</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ac048de75b88caa4883f8c20183f68084">CI_Simple_SetArray</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString)
<a name="l01221"></a>01221 {
<a name="l01222"></a>01222         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL || szString==NULL)
<a name="l01223"></a>01223                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01224"></a>01224         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,szString,16);
<a name="l01225"></a>01225 
<a name="l01226"></a>01226         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01227"></a>01227                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01228"></a>01228         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;setarray &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szProp, szString);
<a name="l01229"></a>01229         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01230"></a>01230 }
<a name="l01231"></a>01231 
<a name="l01247"></a><a class="code" href="ci__ctrl__simple_8h.html#af2cd493ec4f81b9fbfc3b5b4eafcb1c6">01247</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#af2cd493ec4f81b9fbfc3b5b4eafcb1c6">CI_Simple_GetArrIndex</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32Index, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01248"></a>01248 {
<a name="l01249"></a>01249         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01250"></a>01250 
<a name="l01251"></a>01251         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01252"></a>01252                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01253"></a>01253         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,16);
<a name="l01254"></a>01254 
<a name="l01255"></a>01255         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01256"></a>01256                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01257"></a>01257         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01258"></a>01258                 szString[0] = 0;
<a name="l01259"></a>01259         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;getarrayindex &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>), szProp, u32Index);
<a name="l01260"></a>01260         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01261"></a>01261                 <span class="keywordflow">return</span> hr;
<a name="l01262"></a>01262         <span class="keywordflow">return</span> S_OK;
<a name="l01263"></a>01263 }
<a name="l01264"></a>01264 
<a name="l01278"></a><a class="code" href="ci__ctrl__simple_8h.html#aa239e55987649f9684b17d1c09c085f1">01278</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#aa239e55987649f9684b17d1c09c085f1">CI_Simple_SetArrIndex</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32Index, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString)
<a name="l01279"></a>01279 {
<a name="l01280"></a>01280         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL || szString==NULL)
<a name="l01281"></a>01281                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01282"></a>01282         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,szString,16);
<a name="l01283"></a>01283 
<a name="l01284"></a>01284         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01285"></a>01285                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01286"></a>01286         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;setarrayindex &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> , szProp, u32Index, szString);
<a name="l01287"></a>01287         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01288"></a>01288 }
<a name="l01289"></a>01289 
<a name="l01304"></a><a class="code" href="ci__ctrl__simple_8h.html#a300513b8e13ab5034de94b0ac54f4397">01304</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a300513b8e13ab5034de94b0ac54f4397">CI_Simple_Adjust</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szProp, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Adjust, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32Value)
<a name="l01305"></a>01305 {
<a name="l01306"></a>01306         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01307"></a>01307         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> szReturn[32];
<a name="l01308"></a>01308 
<a name="l01309"></a>01309         <span class="keywordflow">if</span>(pHandle==NULL || szProp==NULL)
<a name="l01310"></a>01310                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01311"></a>01311         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szProp,32+16);
<a name="l01312"></a>01312 
<a name="l01313"></a>01313         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01314"></a>01314                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01315"></a>01315         szReturn[0] = 0;
<a name="l01316"></a>01316         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;adjust &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>),szProp,s32Adjust);
<a name="l01317"></a>01317         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szReturn, <a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(szReturn))))
<a name="l01318"></a>01318                 <span class="keywordflow">return</span> hr;
<a name="l01319"></a>01319         s32Value = _ttoi(szReturn);     <span class="comment">// (no check for legitimate integer return)</span>
<a name="l01320"></a>01320         <span class="keywordflow">return</span> S_OK;
<a name="l01321"></a>01321 }
<a name="l01322"></a>01322 
<a name="l01343"></a><a class="code" href="ci__ctrl__simple_8h.html#a9728b4421437a68227133cd25894df9c">01343</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a9728b4421437a68227133cd25894df9c">CI_Simple_Snapshot</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szFilename = NULL)
<a name="l01344"></a>01344 {
<a name="l01345"></a>01345         <span class="keywordflow">if</span>(pHandle==NULL || szType==NULL)
<a name="l01346"></a>01346                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01347"></a>01347         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,szFilename,16);
<a name="l01348"></a>01348 
<a name="l01349"></a>01349         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01350"></a>01350                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01351"></a>01351         <span class="keywordflow">if</span>(szFilename)
<a name="l01352"></a>01352                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;snapshot &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; \&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) ,szType, szFilename);
<a name="l01353"></a>01353         <span class="keywordflow">else</span>
<a name="l01354"></a>01354                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;snapshot &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szType);
<a name="l01355"></a>01355         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01356"></a>01356 }
<a name="l01357"></a>01357 
<a name="l01379"></a><a class="code" href="ci__ctrl__simple_8h.html#af8fd474995d564e63f79e58b051aa2fa">01379</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#af8fd474995d564e63f79e58b051aa2fa">CI_Simple_Thumbnail</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, TCHAR *szType, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> uSeconds = 0)
<a name="l01380"></a>01380 {
<a name="l01381"></a>01381         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l01382"></a>01382                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01383"></a>01383         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(20);
<a name="l01384"></a>01384 
<a name="l01385"></a>01385         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01386"></a>01386                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01387"></a>01387         <span class="keywordflow">if</span>(uSeconds!=0)
<a name="l01388"></a>01388                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;thumbnail &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %u&quot;</span>),szType,uSeconds);
<a name="l01389"></a>01389         <span class="keywordflow">else</span>
<a name="l01390"></a>01390                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;thumbnail &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a>,szType);
<a name="l01391"></a>01391         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01392"></a>01392 }
<a name="l01393"></a>01393 
<a name="l01409"></a><a class="code" href="ci__ctrl__simple_8h.html#a42a9402142926729962953732e120856">01409</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a42a9402142926729962953732e120856">CI_Simple_FrameStep</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l01410"></a>01410 {
<a name="l01411"></a>01411         <span class="keywordflow">if</span>(pHandle==NULL)
<a name="l01412"></a>01412                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01413"></a>01413         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(16);
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01416"></a>01416                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01417"></a>01417         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;framestep&quot;</span>));
<a name="l01418"></a>01418         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01419"></a>01419 }
<a name="l01420"></a>01420 
<a name="l01421"></a>01421 <span class="comment">/*</span>
<a name="l01422"></a>01422 <span class="comment">        RETURNS string blob</span>
<a name="l01423"></a>01423 <span class="comment">                A string blob is a null terminated 2D array of entries.</span>
<a name="l01424"></a>01424 <span class="comment">                Each &quot;row_line&quot; is separated by a newline, designated by (newline).</span>
<a name="l01425"></a>01425 <span class="comment">                Each &quot;column_field&quot; between the row is separated by a tab, designated by (tab).</span>
<a name="l01426"></a>01426 <span class="comment"></span>
<a name="l01427"></a>01427 <span class="comment">                A well formatted string blob always ends with a (newline) before</span>
<a name="l01428"></a>01428 <span class="comment">                the null termination if it contains any entries.  A null blob</span>
<a name="l01429"></a>01429 <span class="comment">                will not contain a (newline) but will be an empty string.</span>
<a name="l01430"></a>01430 <span class="comment"></span>
<a name="l01431"></a>01431 <span class="comment">        Example 1x1 string blob:</span>
<a name="l01432"></a>01432 <span class="comment">                (line0_field0)(newline)</span>
<a name="l01433"></a>01433 <span class="comment"></span>
<a name="l01434"></a>01434 <span class="comment">        Example 1x3 string blob:</span>
<a name="l01435"></a>01435 <span class="comment">                (line0_field0)(tab)(line0_field1)(tab)(line0_field2)(newline)</span>
<a name="l01436"></a>01436 <span class="comment"></span>
<a name="l01437"></a>01437 <span class="comment">        Example 4x4 string blob:</span>
<a name="l01438"></a>01438 <span class="comment">                (line0_field0)(tab)(line0_field1)(tab)(line0_field2)(tab)(line0_field3)(newline)</span>
<a name="l01439"></a>01439 <span class="comment">                (line1_field0)(tab)(line1_field1)(tab)(line1_field2)(tab)(line1_field3)(newline)</span>
<a name="l01440"></a>01440 <span class="comment">                (line2_field0)(tab)(line2_field1)(tab)(line2_field2)(tab)(line2_field3)(newline)</span>
<a name="l01441"></a>01441 <span class="comment">                (line3_field0)(tab)(line3_field1)(tab)(line3_field2)(tab)(line3_field3)(newline)</span>
<a name="l01442"></a>01442 <span class="comment"></span>
<a name="l01443"></a>01443 <span class="comment">        Example variable size blob:</span>
<a name="l01444"></a>01444 <span class="comment">                (line0_field0)(tab)(line0_field1)(newline)</span>
<a name="l01445"></a>01445 <span class="comment">                (line1_field0)(tab)(line1_field1)(tab)(line1_field2)(tab)(line1_field3)(newline)</span>
<a name="l01446"></a>01446 <span class="comment">                (line2_field0)(tab)(line2_field1)(tab)(line2_field2)(tab)(line2_field3)(newline)</span>
<a name="l01447"></a>01447 <span class="comment">                (line3_field0)(tab)(line3_field1)(tab)(line3_field2)(newline)</span>
<a name="l01448"></a>01448 <span class="comment"></span>
<a name="l01449"></a>01449 <span class="comment">*/</span>
<a name="l01450"></a>01450 
<a name="l01480"></a><a class="code" href="ci__ctrl__simple_8h.html#afb8916a302968f8a7f1595c2d993ce0f">01480</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#afb8916a302968f8a7f1595c2d993ce0f">CI_Simple_Show</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szBlob, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32Blob, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Number = -1)
<a name="l01481"></a>01481 {
<a name="l01482"></a>01482         <span class="keywordflow">if</span>(pHandle==NULL || szType==NULL)
<a name="l01483"></a>01483                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01484"></a>01484         <span class="keywordflow">if</span> ((szBlob==NULL &amp;&amp; u32Blob!=0)
<a name="l01485"></a>01485          || (szBlob!=NULL &amp;&amp; u32Blob==0))
<a name="l01486"></a>01486                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01487"></a>01487         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,32+16);
<a name="l01488"></a>01488 
<a name="l01489"></a>01489         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01490"></a>01490                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01491"></a>01491         <span class="keywordflow">if</span> (szBlob)
<a name="l01492"></a>01492                 szBlob[0] = 0;
<a name="l01493"></a>01493         <span class="keywordflow">if</span>(s32Number&gt;=0)
<a name="l01494"></a>01494                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;show &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot; %d&quot;</span>),szType, s32Number);
<a name="l01495"></a>01495         <span class="keywordflow">else</span>
<a name="l01496"></a>01496                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;show &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> ,szType);
<a name="l01497"></a>01497         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szBlob, u32Blob, pu32Returned);
<a name="l01498"></a>01498 }
<a name="l01499"></a>01499 
<a name="l01525"></a><a class="code" href="ci__ctrl__simple_8h.html#a5177fda0d09fcfaeca81e833f17ecc93">01525</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a5177fda0d09fcfaeca81e833f17ecc93">CI_Simple_ShowEx</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szType, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szBlob, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32Blob, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32Id = -1, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szAddition = NULL)
<a name="l01526"></a>01526 {
<a name="l01527"></a>01527         <span class="keywordflow">if</span>(pHandle==NULL || szType==NULL)
<a name="l01528"></a>01528                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01529"></a>01529         <span class="keywordflow">if</span> ((szBlob==NULL &amp;&amp; u32Blob!=0)
<a name="l01530"></a>01530                 || (szBlob!=NULL &amp;&amp; u32Blob==0))
<a name="l01531"></a>01531                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01532"></a>01532         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szType,32+32);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01535"></a>01535                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01536"></a>01536         <span class="keywordflow">if</span> (szBlob)
<a name="l01537"></a>01537                 szBlob[0] = 0;
<a name="l01538"></a>01538         <span class="keywordflow">if</span>(s32Id&gt;=0)
<a name="l01539"></a>01539                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;show &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;ex&quot;</span>) _T(<span class="stringliteral">&quot; %d &quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a>,szType, s32Id, szAddition);
<a name="l01540"></a>01540         <span class="keywordflow">else</span>
<a name="l01541"></a>01541                 _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;show &quot;</span>) __TS _T(<span class="stringliteral">&quot;ex&quot;</span>),szType);
<a name="l01542"></a>01542         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szBlob, u32Blob, pu32Returned);
<a name="l01543"></a>01543 }
<a name="l01544"></a>01544 
<a name="l01561"></a><a class="code" href="ci__ctrl__simple_8h.html#a91eb345e4b94e5e43ac4e9793b66f421">01561</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a91eb345e4b94e5e43ac4e9793b66f421">CI_Simple_EscapeReturnValue</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szCommand, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> &amp;s32Value)
<a name="l01562"></a>01562 {
<a name="l01563"></a>01563         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01564"></a>01564         <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> szReturn[32];
<a name="l01565"></a>01565 
<a name="l01566"></a>01566         <span class="keywordflow">if</span>(pHandle==NULL || szCommand==NULL)
<a name="l01567"></a>01567                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01568"></a>01568         szReturn[0] = 0;
<a name="l01569"></a>01569         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szReturn, <a class="code" href="_mgr_utils_8cpp.html#aad1fea22deb09279b4487665bb0b0d0e">ARRAYSIZE</a>(szReturn))))
<a name="l01570"></a>01570                 <span class="keywordflow">return</span> hr;
<a name="l01571"></a>01571         s32Value = _ttoi(szReturn);     <span class="comment">// (no check for legitimate integer return)</span>
<a name="l01572"></a>01572         <span class="keywordflow">return</span> S_OK;
<a name="l01573"></a>01573 }
<a name="l01574"></a>01574 
<a name="l01592"></a><a class="code" href="ci__ctrl__simple_8h.html#adcf84cfddefd8f4f26bcc5c180d7d470">01592</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#adcf84cfddefd8f4f26bcc5c180d7d470">CI_Simple_EscapeReturnString</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szCommand, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szString, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> u32String, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> *pu32Returned = NULL)
<a name="l01593"></a>01593 {
<a name="l01594"></a>01594         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01595"></a>01595 
<a name="l01596"></a>01596         <span class="keywordflow">if</span>(pHandle==NULL || szCommand==NULL)
<a name="l01597"></a>01597                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01598"></a>01598         <span class="keywordflow">if</span>(szString &amp;&amp; u32String)
<a name="l01599"></a>01599                 szString[0] = 0;
<a name="l01600"></a>01600         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand, szString, u32String, pu32Returned)))
<a name="l01601"></a>01601                 <span class="keywordflow">return</span> hr;
<a name="l01602"></a>01602         <span class="keywordflow">return</span> S_OK;
<a name="l01603"></a>01603 }
<a name="l01604"></a>01604 
<a name="l01618"></a><a class="code" href="ci__ctrl__simple_8h.html#a70d95d5b4e92e0b71c044de90aa845a1">01618</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a70d95d5b4e92e0b71c044de90aa845a1">CI_Simple_RegisterNotify</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="_cipl_mgr_8h.html#abd45628da21f1515bdebb16afe28c9f4">LPFN_CiplMgrNotifyCallback</a> pNotifyCB, <a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pContext)
<a name="l01619"></a>01619 {
<a name="l01620"></a>01620         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01621"></a>01621 
<a name="l01622"></a>01622         <span class="keywordflow">if</span>(pHandle==NULL || pNotifyCB==NULL)
<a name="l01623"></a>01623                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01624"></a>01624         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;RegisterNotify(pContext, pNotifyCB)))
<a name="l01625"></a>01625                 <span class="keywordflow">return</span> hr;
<a name="l01626"></a>01626         <span class="keywordflow">return</span> S_OK;
<a name="l01627"></a>01627 }
<a name="l01628"></a>01628 
<a name="l01640"></a><a class="code" href="ci__ctrl__simple_8h.html#a49dd1f6c8157a2b9c003d981a7fcbc87">01640</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a49dd1f6c8157a2b9c003d981a7fcbc87">CI_Simple_UnregisterNotify</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="_cipl_mgr_8h.html#abd45628da21f1515bdebb16afe28c9f4">LPFN_CiplMgrNotifyCallback</a> pNotifyCB, <a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pContext)
<a name="l01641"></a>01641 {
<a name="l01642"></a>01642         <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> hr;
<a name="l01643"></a>01643 
<a name="l01644"></a>01644         <span class="keywordflow">if</span>(pHandle==NULL || pNotifyCB==NULL)
<a name="l01645"></a>01645                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01646"></a>01646         <span class="keywordflow">if</span>(FAILED(hr = reinterpret_cast&lt;ICiplCtlMgr *&gt;(pHandle)-&gt;UnregisterNotify(pContext, pNotifyCB)))
<a name="l01647"></a>01647                 <span class="keywordflow">return</span> hr;
<a name="l01648"></a>01648         <span class="keywordflow">return</span> S_OK;
<a name="l01649"></a>01649 }
<a name="l01650"></a>01650 
<a name="l01662"></a><a class="code" href="ci__ctrl__simple_8h.html#a111aaa89c494ed8942dda308472d7c37">01662</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a111aaa89c494ed8942dda308472d7c37">CI_Simple_StoreService</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szCachePath)
<a name="l01663"></a>01663 {
<a name="l01664"></a>01664         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szCachePath,13);
<a name="l01665"></a>01665 
<a name="l01666"></a>01666         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01667"></a>01667                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01668"></a>01668         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;storeservice &quot;</span>) _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) ,szCachePath);
<a name="l01669"></a>01669         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01670"></a>01670 }
<a name="l01671"></a>01671 
<a name="l01683"></a><a class="code" href="ci__ctrl__simple_8h.html#adea10ec81c60d25201f48f9c0f0aa0b6">01683</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#adea10ec81c60d25201f48f9c0f0aa0b6">CI_Simple_RestoreService</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szCachePath)
<a name="l01684"></a>01684 {
<a name="l01685"></a>01685         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szCachePath,13);
<a name="l01686"></a>01686 
<a name="l01687"></a>01687         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01688"></a>01688                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01689"></a>01689         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;restoreservice &quot;</span>) _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) ,szCachePath);
<a name="l01690"></a>01690         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01691"></a>01691 }
<a name="l01692"></a>01692 
<a name="l01704"></a><a class="code" href="ci__ctrl__simple_8h.html#a03b4865da299a1cf52cf1f0be10b1b19">01704</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a03b4865da299a1cf52cf1f0be10b1b19">CI_Simple_CleanService</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szCachePath)
<a name="l01705"></a>01705 {
<a name="l01706"></a>01706         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(szCachePath,13);
<a name="l01707"></a>01707 
<a name="l01708"></a>01708         <span class="keywordflow">if</span>(szCommand==NULL)
<a name="l01709"></a>01709                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01710"></a>01710         _stprintf_s(szCommand,szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(),_T(<span class="stringliteral">&quot;cleanservice &quot;</span>) _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) <a class="code" href="ci__ctrl__simple_8h.html#ab8ecb522fca844dbffa3be3a5e7ce585">__TS</a> _T(<span class="stringliteral">&quot;\&quot;&quot;</span>) ,szCachePath);
<a name="l01711"></a>01711         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01712"></a>01712 }
<a name="l01713"></a>01713 
<a name="l01714"></a>01714 <span class="comment">/*</span>
<a name="l01715"></a>01715 <span class="comment">    Starts the signal test of a tuner with a DTV frequency.</span>
<a name="l01716"></a>01716 <span class="comment"></span>
<a name="l01717"></a>01717 <span class="comment">    @param pHandle is the Manager instance created by CI_Simple_CreateManager().</span>
<a name="l01718"></a>01718 <span class="comment">    @param szSession is the session name, which can be NULL.</span>
<a name="l01719"></a>01719 <span class="comment">    @param s32TestFrequencyKhz is the test frequency in KHz (or channel number)</span>
<a name="l01720"></a>01720 <span class="comment">    @return</span>
<a name="l01721"></a>01721 <span class="comment">     CI_SOK on success.</span>
<a name="l01722"></a>01722 <span class="comment">     CI_EFAIL on failure.</span>
<a name="l01723"></a>01723 <span class="comment">     CI_EUNEXPECTED if Manager is not opened.</span>
<a name="l01724"></a>01724 <span class="comment">     CI_EPOINTER if pHandle is NULL.</span>
<a name="l01725"></a>01725 <span class="comment">*/</span>
<a name="l01726"></a><a class="code" href="ci__ctrl__simple_8h.html#ab3b7a32c5a41d571f68d6bcf6b3b9aa8">01726</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ab3b7a32c5a41d571f68d6bcf6b3b9aa8">CI_Simple_StartSignalTest</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32TestFrequencyKhz, <a class="code" href="ci__ctrl__type_8h.html#a49ad1f7e8c34c287b1ff41e31a88950d">CI_S32</a> s32TestBandwidthKHz)
<a name="l01727"></a>01727 {
<a name="l01728"></a>01728     <span class="keywordflow">if</span> (NULL == pHandle)
<a name="l01729"></a>01729     {
<a name="l01730"></a>01730         <span class="keywordflow">return</span> E_POINTER;
<a name="l01731"></a>01731     }
<a name="l01732"></a>01732 
<a name="l01733"></a>01733     <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l01734"></a>01734     <span class="keywordflow">if</span> (NULL == szCommand)
<a name="l01735"></a>01735     {
<a name="l01736"></a>01736         <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01737"></a>01737     }
<a name="l01738"></a>01738 
<a name="l01739"></a>01739     _stprintf_s(szCommand, szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(), _T(<span class="stringliteral">&quot;StartSignalTest %d %d&quot;</span>), s32TestFrequencyKhz, s32TestBandwidthKHz);
<a name="l01740"></a>01740     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01741"></a>01741 }
<a name="l01742"></a>01742 
<a name="l01743"></a>01743 <span class="comment">/*</span>
<a name="l01744"></a>01744 <span class="comment">    Stops the signal test of a tuner.</span>
<a name="l01745"></a>01745 <span class="comment"></span>
<a name="l01746"></a>01746 <span class="comment">    @param pHandle is the Manager instance created by CI_Simple_CreateManager().</span>
<a name="l01747"></a>01747 <span class="comment">    @param szSession is the session name, which can be NULL.</span>
<a name="l01748"></a>01748 <span class="comment">    @return</span>
<a name="l01749"></a>01749 <span class="comment">    CI_SOK on success.</span>
<a name="l01750"></a>01750 <span class="comment">    CI_EFAIL on failure.</span>
<a name="l01751"></a>01751 <span class="comment">    CI_EUNEXPECTED if Manager is not opened.</span>
<a name="l01752"></a>01752 <span class="comment">    CI_EPOINTER if pHandle is NULL.</span>
<a name="l01753"></a>01753 <span class="comment">*/</span>
<a name="l01754"></a><a class="code" href="ci__ctrl__simple_8h.html#ad59015b6818edc563f8954625df0fc79">01754</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#ad59015b6818edc563f8954625df0fc79">CI_Simple_StopSignalTest</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession)
<a name="l01755"></a>01755 {
<a name="l01756"></a>01756     <span class="keywordflow">if</span> (NULL == pHandle)
<a name="l01757"></a>01757     {
<a name="l01758"></a>01758         <span class="keywordflow">return</span> E_POINTER;
<a name="l01759"></a>01759     }
<a name="l01760"></a>01760 
<a name="l01761"></a>01761     <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l01762"></a>01762     <span class="keywordflow">if</span> (NULL == szCommand)
<a name="l01763"></a>01763     {
<a name="l01764"></a>01764         <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01765"></a>01765     }
<a name="l01766"></a>01766 
<a name="l01767"></a>01767     _stprintf_s(szCommand, szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(), _T(<span class="stringliteral">&quot;StopSignalTest&quot;</span>));
<a name="l01768"></a>01768     <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01769"></a>01769 }
<a name="l01770"></a>01770 
<a name="l01771"></a>01771 <span class="comment">/*</span>
<a name="l01772"></a>01772 <span class="comment">Load preset service list of region. (only 1-seg support)</span>
<a name="l01773"></a>01773 <span class="comment"></span>
<a name="l01774"></a>01774 <span class="comment">@param pHandle is the Manager instance created by CI_Simple_CreateManager().</span>
<a name="l01775"></a>01775 <span class="comment">@param szSession is the session name, which can be NULL.</span>
<a name="l01776"></a>01776 <span class="comment">@param dwCountryCode</span>
<a name="l01777"></a>01777 <span class="comment">@param dwRegionID</span>
<a name="l01778"></a>01778 <span class="comment">@return</span>
<a name="l01779"></a>01779 <span class="comment">CI_SOK on success.</span>
<a name="l01780"></a>01780 <span class="comment">CI_EFAIL on failure.</span>
<a name="l01781"></a>01781 <span class="comment">CI_EUNEXPECTED if Manager is not opened.</span>
<a name="l01782"></a>01782 <span class="comment">CI_EPOINTER if pHandle is NULL.</span>
<a name="l01783"></a>01783 <span class="comment">*/</span>
<a name="l01784"></a><a class="code" href="ci__ctrl__simple_8h.html#a128b6a59b2f262747d855ae0ddb0a199">01784</a> <span class="keyword">inline</span> <a class="code" href="ci__ctrl__type_8h.html#a2bbc7ea7e0ee305205dc00c96cd61c58">CI_RESULT</a> <a class="code" href="ci__ctrl__simple_8h.html#a128b6a59b2f262747d855ae0ddb0a199">CI_Simple_LoadPreset</a>(<a class="code" href="ci__ctrl__type_8h.html#a063165f5e08e0193381ff2083392e666">CI_VOID</a> *pHandle, <a class="code" href="ci__ctrl__type_8h.html#acffea40fa9dd113b8a33a66ad54b0484">CI_TCHAR</a> *szSession, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> dwCountryCode, <a class="code" href="ci__ctrl__type_8h.html#a1ef9dd930cff5672556c7664f1823fea">CI_U32</a> dwRegionID)
<a name="l01785"></a>01785 {
<a name="l01786"></a>01786         <span class="keywordflow">if</span> (NULL == pHandle)
<a name="l01787"></a>01787         {
<a name="l01788"></a>01788                 <span class="keywordflow">return</span> E_POINTER;
<a name="l01789"></a>01789         }
<a name="l01790"></a>01790 
<a name="l01791"></a>01791         <a class="code" href="class_c_i___string_alloc.html">CI_StringAlloc</a> szCommand(32+32+32+16);
<a name="l01792"></a>01792         <span class="keywordflow">if</span> (NULL == szCommand)
<a name="l01793"></a>01793         {
<a name="l01794"></a>01794                 <span class="keywordflow">return</span> E_OUTOFMEMORY;
<a name="l01795"></a>01795         }
<a name="l01796"></a>01796 
<a name="l01797"></a>01797         _stprintf_s(szCommand, szCommand.<a class="code" href="class_c_i___string_alloc.html#adecdc196a41e4159651979216a8e26cd">size</a>(), _T(<span class="stringliteral">&quot;load preset %u %u&quot;</span>), dwCountryCode, dwRegionID);
<a name="l01798"></a>01798         <span class="keywordflow">return</span> <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="struct_i_cipl_ctl_mgr.html">ICiplCtlMgr</a> *<span class="keyword">&gt;</span>(pHandle)-&gt;ExecuteImmediateCmdString(szSession, szCommand);
<a name="l01799"></a>01799 }
<a name="l01800"></a>01800 
<a name="l01801"></a>01801 <span class="preprocessor">#endif //_CI_CTRL_SIMPLE_H_</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Oct 26 2015 10:59:07 for Cipl Simple API by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
